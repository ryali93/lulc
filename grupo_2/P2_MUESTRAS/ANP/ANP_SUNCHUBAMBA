/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var bofedal = /* color: #32ffa1 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.46227712059824, -7.384961846898697],
                  [-78.46141881371348, -7.385312961467417],
                  [-78.46085018540232, -7.385589596991805],
                  [-78.46057123566477, -7.385249122475671],
                  [-78.46157974625437, -7.384568172656674]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.43144828301031, -7.383208444591075],
                  [-78.43139463883001, -7.383474441557024],
                  [-78.43134099464972, -7.383756398166226],
                  [-78.43140536766607, -7.383942595828436],
                  [-78.43146974068243, -7.384213912281569],
                  [-78.43115324001867, -7.384490548493708],
                  [-78.43094402771551, -7.384400109751087],
                  [-78.43091184120733, -7.384166032919577],
                  [-78.43107277374823, -7.383889396504379],
                  [-78.4311049602564, -7.383649999466905],
                  [-78.43094939213354, -7.383586160235014],
                  [-78.4308689258631, -7.383399962422696],
                  [-78.43115324001867, -7.3833361231547],
                  [-78.43138927441198, -7.383048846334701]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.44243034175216, -7.380273225220787],
                  [-78.44277366450606, -7.380613703568306],
                  [-78.44201191714583, -7.3807413828810535],
                  [-78.44082101634322, -7.3807413828810535],
                  [-78.44068154147445, -7.380400904631812],
                  [-78.44177588275252, -7.379975306451739]]]),
            {
              "system:index": "2"
            })]),
    cuerpo_agua = /* color: #303fff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.46528655911295, -7.382732794874531],
                  [-78.46532411003916, -7.382759394606946],
                  [-78.46529192353098, -7.382929632856469],
                  [-78.46512562657206, -7.383110510924781],
                  [-78.46423513317912, -7.383807422790333],
                  [-78.46362895394175, -7.383855302191154],
                  [-78.46342510605662, -7.383711663973146],
                  [-78.4635484876713, -7.383435027273645],
                  [-78.46395618344157, -7.38321690975392],
                  [-78.46495932961314, -7.382743434767684]]]),
            {
              "system:index": "0"
            })]),
    afloramiento_rocoso = /* color: #ff75f4 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.45921919354237, -7.383408481388797],
                  [-78.45747039326466, -7.384419268550762],
                  [-78.45736310490406, -7.384046873549411],
                  [-78.45778152951038, -7.383759597191216],
                  [-78.45889732846058, -7.383206323679112]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.45829651364124, -7.380142027078416],
                  [-78.45778152951038, -7.380897463281678],
                  [-78.4572450877074, -7.381163461637658],
                  [-78.45681593426502, -7.380918743156044],
                  [-78.45782444485462, -7.379716428649266]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.46183166512287, -7.379407869532081],
                  [-78.46164927490986, -7.379482349338691],
                  [-78.46150980004109, -7.379375949611133],
                  [-78.4612415791396, -7.379375949611133],
                  [-78.46084997662342, -7.379461069395231],
                  [-78.46016333111561, -7.379461069395231],
                  [-78.45962688931263, -7.379445109436963],
                  [-78.45952496537006, -7.3792908298106505],
                  [-78.45991656788624, -7.379184430037027],
                  [-78.46059784897602, -7.379125910150631],
                  [-78.46116111286915, -7.379008870354598],
                  [-78.46157953747547, -7.379019510337339]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.45105991371906, -7.382004015391082],
                  [-78.45108137139118, -7.382121054394598],
                  [-78.45092043885029, -7.382270013081551],
                  [-78.45021233567036, -7.382376412112923],
                  [-78.44935402878559, -7.3825413305609855],
                  [-78.44856545933521, -7.382498770967374],
                  [-78.4485440016631, -7.382291292889875],
                  [-78.44900534161366, -7.38215829407104],
                  [-78.44968662270344, -7.381961455745769],
                  [-78.45031425961292, -7.381886976356588]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.43173259716589, -7.382229574378478],
                  [-78.43013400059301, -7.382995646903102],
                  [-78.42937225323278, -7.382953087353218],
                  [-78.42916840534765, -7.382144455127163],
                  [-78.43063825588781, -7.381633739275172]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.44021109781272, -7.383442504937974],
                  [-78.44012526712424, -7.383676582152552],
                  [-78.43914894304282, -7.3840808970494685],
                  [-78.43876806936271, -7.384203255432232],
                  [-78.43817798337943, -7.384171335857392],
                  [-78.43815116128928, -7.384070257188492],
                  [-78.43903092584617, -7.383825540315487],
                  [-78.43973366460807, -7.383618062860526]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64129554775735, -7.4175642550345415],
                  [-78.64131968763849, -7.417638728400794],
                  [-78.64124726799508, -7.4177025627046955],
                  [-78.64113461521646, -7.41771320175444],
                  [-78.64113461521646, -7.417811612952432],
                  [-78.6412150814869, -7.417832891046401],
                  [-78.64122581032296, -7.417928642456522],
                  [-78.64108365324518, -7.417925982695418],
                  [-78.64101391581079, -7.417816932476013],
                  [-78.64103000906488, -7.417657346740389],
                  [-78.64115875509759, -7.417548296454422]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64100050476571, -7.416691851805713],
                  [-78.64094686058542, -7.41677164485581],
                  [-78.64089589861413, -7.416936550446836],
                  [-78.64074301270028, -7.41692857114546],
                  [-78.640692050729, -7.416707810416889],
                  [-78.64071887281915, -7.416588120818972],
                  [-78.64082347897073, -7.416577481742026]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64236843136331, -7.416245010457876],
                  [-78.64244353321573, -7.41633810244276],
                  [-78.64250254181405, -7.416492369117205],
                  [-78.64248108414193, -7.416580141511285],
                  [-78.64235770252725, -7.416561523126118],
                  [-78.64223432091256, -7.41640725647591],
                  [-78.64221018103143, -7.416197134572268],
                  [-78.64227187183877, -7.416162557540547]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64167744630244, -7.414336283507588],
                  [-78.64152187817957, -7.414495870447257],
                  [-78.64129657262232, -7.413953274616411],
                  [-78.64113564008143, -7.41362878071178],
                  [-78.64111954682734, -7.4135170696401],
                  [-78.64125365727809, -7.413511750064548],
                  [-78.6414896916714, -7.413548987092047],
                  [-78.64155406468775, -7.413761770045883],
                  [-78.64170963281062, -7.414027748593573],
                  [-78.6418330144253, -7.414128820399561]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.59721341596767, -7.536695962091417],
                  [-78.59719195829555, -7.536892730827157],
                  [-78.5969291018121, -7.537355402907567],
                  [-78.59675207601711, -7.537147998243007],
                  [-78.59689155088589, -7.53685018624322],
                  [-78.59718659387752, -7.536376877465048]]]),
            {
              "system:index": "10"
            })]),
    matorral = /* color: #999900 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.58565696268322, -7.539691543373011],
                  [-78.58560331847791, -7.539914901030512],
                  [-78.58447679016571, -7.540574337251654],
                  [-78.58435877291396, -7.5402871635369015],
                  [-78.58444460364252, -7.540010625705592],
                  [-78.58488985058887, -7.539824494642402],
                  [-78.58542092817973, -7.539627726878276]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.58901321053591, -7.5444255141348116],
                  [-78.58880936265078, -7.544797772587126],
                  [-78.58796178460207, -7.545095579118343],
                  [-78.58739315629091, -7.5450530353407155],
                  [-78.5872644102582, -7.5444042422135755],
                  [-78.58824073433962, -7.543946895654001]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.58577338037857, -7.542709162923062],
                  [-78.58471122560867, -7.543304778655891],
                  [-78.58428207216629, -7.543251598713079],
                  [-78.58416405496963, -7.54262407489431],
                  [-78.58529058275589, -7.542241178557837]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.57084136081306, -7.544686550831532],
                  [-78.56961827350227, -7.544761002502687],
                  [-78.56915693355171, -7.544633371058561],
                  [-78.56912474704353, -7.544218568605089],
                  [-78.56978993487922, -7.543761221849237],
                  [-78.57022981715767, -7.543888853550671],
                  [-78.57047658038704, -7.544441923821767]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.57139926028816, -7.544420651901333],
                  [-78.57107739520637, -7.544404697960331],
                  [-78.57107739520637, -7.543979259316396],
                  [-78.57159774375526, -7.543947351401241]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.57504843060919, -7.518952295567783],
                  [-78.57458709065862, -7.518994841908009],
                  [-78.57445834462591, -7.519324575903305],
                  [-78.57414720838018, -7.518941658982078],
                  [-78.57352493588873, -7.518611924695938],
                  [-78.57373951260992, -7.518452375757882],
                  [-78.57395408933111, -7.518324736565223],
                  [-78.57424376790472, -7.518346009766608],
                  [-78.57458709065862, -7.518484285550188],
                  [-78.57488749806829, -7.518771473575346]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.51712376391771, -7.550946491435902],
                  [-78.51659805095079, -7.551185796868897],
                  [-78.51629764354112, -7.551031577827265],
                  [-78.51634055888536, -7.5505370129432166],
                  [-78.51703793322923, -7.5505370129432166]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.51197186330089, -7.55360477867728],
                  [-78.51161781171092, -7.553679228812673],
                  [-78.51115647176036, -7.553498421318744],
                  [-78.51144078591594, -7.553041084378758],
                  [-78.51192358353862, -7.553200620575589]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.52332082789887, -7.5437588236846205],
                  [-78.52258053821076, -7.5443863458575775],
                  [-78.52223721545685, -7.543418472294844],
                  [-78.52254835170258, -7.542876036714033],
                  [-78.52319208186616, -7.543365292366014]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.49591051576242, -7.547264433763269],
                  [-78.49528824327096, -7.547232526090446],
                  [-78.49529897210702, -7.546243387065369],
                  [-78.49618946549997, -7.546275294811164]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.49554131396093, -7.540829672121797],
                  [-78.49593828089513, -7.5419251837556365],
                  [-78.49491904146947, -7.54219108421941],
                  [-78.49451134569921, -7.54131893008735]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.50046598616278, -7.5492283149454344],
                  [-78.50036942663824, -7.549760106730376],
                  [-78.49961840811407, -7.549749470901096],
                  [-78.49959695044195, -7.549047505589533]]]),
            {
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.47759025242289, -7.540580292377252],
                  [-78.47731130268534, -7.5405058399867695],
                  [-78.47702162411173, -7.540106987676807],
                  [-78.47731130268534, -7.539878312186661],
                  [-78.47773509170969, -7.540287800769528]]]),
            {
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.47919421341379, -7.540729197119822],
                  [-78.47904937412699, -7.540984462273585],
                  [-78.47874896671732, -7.540920645999257],
                  [-78.47844855930765, -7.540633472648336],
                  [-78.47887771275003, -7.540404797436337]]]),
            {
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.46396097232969, -7.535255283646095],
                  [-78.46322068264158, -7.53563286807297],
                  [-78.46300074150236, -7.535175512246201],
                  [-78.463478174707, -7.534829836010185]]]),
            {
              "system:index": "14"
            })]),
    pastizal = /* color: #f0f41f */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.43824559737848, -7.383388818869614],
                  [-78.4379237322967, -7.383633535984341],
                  [-78.4363036780517, -7.383963371881199],
                  [-78.4359603552978, -7.383144101619435],
                  [-78.43805247832941, -7.38254826774834]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64012379321619, -7.401281817236006],
                  [-78.63946933421656, -7.40196274128059],
                  [-78.63775272044703, -7.401249898895628],
                  [-78.63798875484034, -7.400473218567741],
                  [-78.6393513170199, -7.400622171065385]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.63081902704346, -7.399686435499743],
                  [-78.63031477174866, -7.400154572586464],
                  [-78.62975687227356, -7.399877946186171],
                  [-78.62978905878174, -7.399111902941683],
                  [-78.63048643312561, -7.3993034138775045]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.62299677865212, -7.400611982087232],
                  [-78.6226319982261, -7.4012503493792785],
                  [-78.62190243737405, -7.401186512691655],
                  [-78.62209555642312, -7.400367274380344],
                  [-78.62266418473428, -7.400377913848675]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.61180740220136, -7.4049963593898624],
                  [-78.61161428315229, -7.405017638102931],
                  [-78.61114221436567, -7.4049963593898624],
                  [-78.61121731621809, -7.404570784913011],
                  [-78.61178594452925, -7.404485669968332]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.6468550760497, -7.401033957206708],
                  [-78.64622207472219, -7.400757331357885],
                  [-78.64650102445974, -7.3998742553719605],
                  [-78.64719839880361, -7.400161521248128]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64605235538934, -7.409608031170071],
                  [-78.64524769268488, -7.409586752678648],
                  [-78.64530133686517, -7.408948397458025],
                  [-78.64625620327448, -7.40903351154089]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64629439384431, -7.426880821920607],
                  [-78.64629439384431, -7.425774382430737],
                  [-78.6472814467618, -7.425902048667856],
                  [-78.64747456581087, -7.42658293463961]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.59750222585957, -7.49397636254003],
                  [-78.5972018184499, -7.49314666041909],
                  [-78.59789919279378, -7.492348868427837],
                  [-78.59828543089192, -7.492987102137721]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.59986450191238, -7.495582576256883],
                  [-78.59925295825698, -7.49525282425522],
                  [-78.59941389079788, -7.494593319502836],
                  [-78.59978940005996, -7.4948273374325085]]]),
            {
              "system:index": "9"
            })]),
    urbano = /* color: #ff4309 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.47806786710571, -7.383563428448008],
                  [-78.47810541803192, -7.383629927651096],
                  [-78.4781027358229, -7.383712386649061],
                  [-78.47801422292541, -7.3837522861586775],
                  [-78.47799812967132, -7.383893264397155],
                  [-78.4779042523558, -7.383903904262393],
                  [-78.47788011247466, -7.383789525697733],
                  [-78.47797130758117, -7.383680467038764],
                  [-78.47791498119186, -7.383571408352901],
                  [-78.47799008304428, -7.3835235289213434]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.4784621518309, -7.383720366551269],
                  [-78.4783736389334, -7.383778885829746],
                  [-78.47833340579818, -7.383741646289788],
                  [-78.47838168556045, -7.383688446941558]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.55083350156656, -7.539221099277109],
                  [-78.55053845857492, -7.538971151130713],
                  [-78.55061892484537, -7.538907334559563],
                  [-78.5507691285502, -7.538997741365916],
                  [-78.55092469667306, -7.539130692517409]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.54995373700967, -7.538495185644388],
                  [-78.54993496154657, -7.538556343250148],
                  [-78.549833037604, -7.5385510251978145],
                  [-78.54979816888681, -7.538500503697408],
                  [-78.5498142621409, -7.538447323164297],
                  [-78.54988399957529, -7.538442005110628]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.484943811557, -7.542379885372412],
                  [-78.48506182875366, -7.542449019436081],
                  [-78.48511547293396, -7.542613877543284],
                  [-78.48500282015533, -7.542635149552557],
                  [-78.48500282015533, -7.542930298573118],
                  [-78.4848526164505, -7.542906367578948],
                  [-78.48476142134399, -7.542792030588551],
                  [-78.48460853543014, -7.542624513548054],
                  [-78.4846380397293, -7.54256335651711],
                  [-78.48474801029892, -7.542576651524575],
                  [-78.48489553179473, -7.542531448497532],
                  [-78.48489553179473, -7.542488904467774]]]),
            {
              "system:index": "4"
            })]),
    bosque = /* color: #2fe93f */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.62539656833171, -7.407893505879383],
                  [-78.6255038566923, -7.4080743737188035],
                  [-78.62553604203077, -7.408563779262756],
                  [-78.62642653659343, -7.41030861737661],
                  [-78.62614758685588, -7.410702268656581],
                  [-78.62560041621684, -7.4102979781479394],
                  [-78.62527855113505, -7.409648984713487],
                  [-78.62502105906962, -7.408776565803482],
                  [-78.62482794002055, -7.4082446022057145],
                  [-78.62519272044658, -7.407819030865119]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64065025784743, -7.4080947786366975],
                  [-78.64054296948683, -7.408924641850862],
                  [-78.64026401974928, -7.409105509267014],
                  [-78.64006017186415, -7.408796970688872],
                  [-78.63960956074965, -7.408233089280926],
                  [-78.63920186497938, -7.407881992945421],
                  [-78.63925550915968, -7.407679846443541],
                  [-78.63968466260206, -7.407892632232422],
                  [-78.64010308720839, -7.407977746519211],
                  [-78.640392765782, -7.407818157218006]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64599412064153, -7.4413131981120015],
                  [-78.64524310211736, -7.441398305929287],
                  [-78.64348357300359, -7.440759996897189],
                  [-78.6437196073969, -7.439759977546366],
                  [-78.64537184815008, -7.440377011032146]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.6477536497553, -7.436866291692825],
                  [-78.64693825821477, -7.437334389227389],
                  [-78.64627307037908, -7.4368024601721645],
                  [-78.6457366285761, -7.4355683822815815],
                  [-78.64715283493597, -7.435504550572187]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.59377273724688, -7.4953229448861745],
                  [-78.59317192242754, -7.495556962423788],
                  [-78.59282859967364, -7.494929369652961],
                  [-78.59317192242754, -7.494386873478219],
                  [-78.59357961819781, -7.494759174847348]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.60113951153525, -7.525233425126063],
                  [-78.60111805386313, -7.525345107643538],
                  [-78.60111537165412, -7.525451471919169],
                  [-78.60106709189185, -7.5255126313658325],
                  [-78.60097321457633, -7.525480722090392],
                  [-78.60097053236731, -7.525374357821937],
                  [-78.6009866256214, -7.525212152262327],
                  [-78.60106977410086, -7.525060583078022],
                  [-78.60117169804343, -7.525084515058011]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.54046062514743, -7.54274221268479],
                  [-78.54014412448367, -7.542311454400038],
                  [-78.5404016165491, -7.541742427366559],
                  [-78.54083076999149, -7.542364634458394]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.41838688161259, -7.444654365253527],
                  [-78.41752857472783, -7.444654365253527],
                  [-78.41720670964604, -7.44434585162774],
                  [-78.4172710826624, -7.443728823724991],
                  [-78.41836542394047, -7.443813931073538]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.41397045193509, -7.307500657021204],
                  [-78.41495750485257, -7.306926005159125],
                  [-78.41517208157376, -7.308032741419682],
                  [-78.41483948765591, -7.308958566762433],
                  [-78.41446397839383, -7.30883086682922],
                  [-78.41418502865628, -7.30825621667809]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.40253542424082, -7.313360016258379],
                  [-78.4022242879951, -7.31341322402868],
                  [-78.40156982899546, -7.312913070737477],
                  [-78.40165565968394, -7.312455483193013],
                  [-78.40243886471629, -7.312423558463105],
                  [-78.40311478138804, -7.312838579773826]]]),
            {
              "system:index": "9"
            })]),
    pastos = /* color: #fff1aa */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.64405460029472, -7.457425267945082],
                  [-78.64467687278618, -7.45804227655811],
                  [-78.64371127754082, -7.458638008186725],
                  [-78.64253110557426, -7.4585529037180045],
                  [-78.64195174842705, -7.457021020451166],
                  [-78.64321775108208, -7.45648911528515]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.63762802749504, -7.451233857516431],
                  [-78.63720960288872, -7.451361516347157],
                  [-78.63703794151176, -7.45180832196173],
                  [-78.63678044944633, -7.451755130841048],
                  [-78.6367911782824, -7.451212581041022],
                  [-78.6371345010363, -7.450957263255567]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.60224971620694, -7.467261972033466],
                  [-78.60189566461698, -7.467506642464595],
                  [-78.60138068048612, -7.467506642464595],
                  [-78.60103735773221, -7.467815139769543],
                  [-78.60110173074857, -7.4672087827911815],
                  [-78.60165963022366, -7.466793906479263],
                  [-78.60229263155118, -7.467006663611476]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.59498015846815, -7.468277523800003],
                  [-78.59451881851759, -7.468745587765505],
                  [-78.59415403809156, -7.46842645329795],
                  [-78.5942505976161, -7.46736267005652],
                  [-78.59510890450086, -7.467660529625091]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.5967718740901, -7.466532917331047],
                  [-78.5967182299098, -7.467022258872494],
                  [-78.59618178810682, -7.467096723841638],
                  [-78.59566680397596, -7.466469090133079],
                  [-78.5966109415492, -7.465884007050885]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.58970255446181, -7.469541116212593],
                  [-78.58962745260939, -7.469966627698915],
                  [-78.58837217879042, -7.470328312136499],
                  [-78.58763188910231, -7.470126194399454],
                  [-78.58723492216811, -7.469530478420122],
                  [-78.58792156767592, -7.469041139686736],
                  [-78.58894080710158, -7.469062415295228]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.59220773768172, -7.462125663487751],
                  [-78.59201998305068, -7.462178853348322],
                  [-78.59185905050978, -7.462067154633644],
                  [-78.5917732198213, -7.461838438128911],
                  [-78.59205753397688, -7.461370366769687],
                  [-78.59239012789473, -7.461689506387121]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.60227069735052, -7.494228885740275],
                  [-78.60207757830145, -7.494452266680975],
                  [-78.60178789972784, -7.494048053466263],
                  [-78.60206684946539, -7.493420458521119],
                  [-78.60273203730108, -7.4935906538498465]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.54858264072796, -7.538774516327763],
                  [-78.54863092049023, -7.53885428706469],
                  [-78.54850753887554, -7.538886195355341],
                  [-78.54826077564617, -7.539114871369553],
                  [-78.54794963940044, -7.5393701374753075],
                  [-78.54776724918743, -7.539242504441247],
                  [-78.54825541122814, -7.538811742673483]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.54715570553203, -7.54005616438868],
                  [-78.54710206135174, -7.540704964035067],
                  [-78.54645296677013, -7.540816642564622],
                  [-78.5465012465324, -7.540587967449401],
                  [-78.54678556068798, -7.540513515060229],
                  [-78.54676410301586, -7.540348656152925],
                  [-78.5466621790733, -7.540109344724152],
                  [-78.54676410301586, -7.539742400276381],
                  [-78.5470055018272, -7.539864715126867]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.48454310127987, -7.5455232547254285],
                  [-78.48432047793163, -7.545685452678857],
                  [-78.4839369220425, -7.545637590994018],
                  [-78.48390473553432, -7.545315853975078],
                  [-78.48432852455868, -7.545233425444105]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.48286481513637, -7.545813475244737],
                  [-78.48276557340282, -7.5459437653214305],
                  [-78.4825456322636, -7.54587463181623],
                  [-78.4824571193661, -7.545741682736728],
                  [-78.48297478570598, -7.545648618356756]]]),
            {
              "system:index": "11"
            })]),
    bosque_seco = /* color: #1be764 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.57758658935992, -7.512019305086067],
                  [-78.57687848618, -7.511125816715857],
                  [-78.57584851791827, -7.511125816715857],
                  [-78.57526916077106, -7.510891807553396],
                  [-78.5758699755904, -7.510253600106242],
                  [-78.57696431686847, -7.5098919488034985],
                  [-78.57801574280231, -7.5103174208931165],
                  [-78.5785736422774, -7.511147090269826]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.57567308994575, -7.514961659067508],
                  [-78.57598422619148, -7.515344579498655],
                  [-78.57603787037178, -7.515865776209651],
                  [-78.5753941402082, -7.515972142808513],
                  [-78.57507227512642, -7.515759409584735],
                  [-78.57491134258552, -7.515599859598519],
                  [-78.57496498676582, -7.5152701227745915],
                  [-78.5753404960279, -7.515046752525821],
                  [-78.57553361507698, -7.5147276519711586]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.58317534503419, -7.529533950191348],
                  [-78.58439843234498, -7.531469757221113],
                  [-78.58283202228029, -7.532469566256853],
                  [-78.58197371539552, -7.53144848466337],
                  [-78.58216683444459, -7.529682858731347]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.59125101011763, -7.532957047917043],
                  [-78.59030687254439, -7.5349992015873575],
                  [-78.58916961592207, -7.534190850243961],
                  [-78.59022104185591, -7.5324465079954255]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.59606825649921, -7.5399450018547896],
                  [-78.59484517108186, -7.540434260062903],
                  [-78.5945018488593, -7.539402562760183],
                  [-78.59529578149875, -7.539030300243024],
                  [-78.59602534122152, -7.53907284454694]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.60299936966592, -7.54389512803278],
                  [-78.60236636833841, -7.54426738694149],
                  [-78.60186211304361, -7.5448310926791695],
                  [-78.60148660378152, -7.544884272427816],
                  [-78.60107890801126, -7.544799184826824],
                  [-78.60083214478189, -7.5447034612557164],
                  [-78.60104672150308, -7.544320566759435],
                  [-78.60161534981424, -7.544150391318972],
                  [-78.60231272415811, -7.543682408512562]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.60478035645181, -7.541795005866763],
                  [-78.60488764481241, -7.543039419004577],
                  [-78.60442630486185, -7.543390406678466],
                  [-78.60396496491128, -7.5428054270638265],
                  [-78.60416881279642, -7.54106111951831],
                  [-78.60485545830423, -7.54121002409544]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.59680064203752, -7.532711933703144],
                  [-78.59747655870927, -7.5325842987069365],
                  [-78.59786279680742, -7.532828932416654],
                  [-78.59806664469255, -7.533020384788769],
                  [-78.59780915262712, -7.533179928367592],
                  [-78.5972297954799, -7.5333926530479545],
                  [-78.5964895057918, -7.533764920987266],
                  [-78.59619982721819, -7.533775557209408],
                  [-78.59538443567766, -7.533520287806042],
                  [-78.59547026636614, -7.533275654486681],
                  [-78.59608181002153, -7.533211837076296],
                  [-78.59656460764421, -7.532860841151209]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.56730427297975, -7.524761505191302],
                  [-78.56755103620912, -7.525697511181049],
                  [-78.5662313893738, -7.526910061391522],
                  [-78.5658344224396, -7.526442059957659],
                  [-78.56618847402956, -7.52398504414434],
                  [-78.56731500181581, -7.524346683708993]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.54414190232156, -7.547063404991583],
                  [-78.54320849358437, -7.546978317819279],
                  [-78.54295100151894, -7.54585091120588],
                  [-78.54331578194497, -7.545393566175784],
                  [-78.54389513909219, -7.546116809256884]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.5353905030609, -7.545336045967647],
                  [-78.53487551893004, -7.545750847349577],
                  [-78.5344356366516, -7.545612580266468],
                  [-78.53414595807799, -7.545080783381075],
                  [-78.5349398919464, -7.544697889218765]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.58990954745582, -7.522418101211646],
                  [-78.5892765461283, -7.522843561028406],
                  [-78.58864354480079, -7.522662740657265],
                  [-78.58823584903053, -7.521822456767314],
                  [-78.58897613871864, -7.5219075488808524]]]),
            {
              "system:index": "11"
            })]),
    area_sin_vegetacion = /* color: #3edaff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.55555102656345, -7.538833564119366],
                  [-78.55541155169468, -7.538870790460023],
                  [-78.55510041544895, -7.538870790460023],
                  [-78.55519697497348, -7.538562343540848],
                  [-78.555470560293, -7.538721885078212]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.55281880676037, -7.538511665336803],
                  [-78.55283490001446, -7.538639298586328],
                  [-78.55276516258007, -7.5387562956986685],
                  [-78.55267396747357, -7.538612708329104],
                  [-78.55262032329327, -7.538314897336739],
                  [-78.55281344234234, -7.538309579281441]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.55197768184414, -7.537903335590673],
                  [-78.55185430022945, -7.53800969678399],
                  [-78.55167191001644, -7.537956516190601],
                  [-78.55192403766384, -7.5378342008010115]]]),
            {
              "system:index": "2"
            })]),
    playa = /* color: #ff9ef7 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.53317911219321, -7.549051799517698],
                  [-78.53301281523429, -7.549312377680452],
                  [-78.53250319552146, -7.5496580423478745],
                  [-78.5320794064971, -7.549626134851687],
                  [-78.53194529604636, -7.549354921039049],
                  [-78.5323476273986, -7.54906775328728],
                  [-78.53300208639823, -7.548881625938877]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.52917585966043, -7.549504796333617],
                  [-78.52849457857064, -7.549531385921397],
                  [-78.52852676507882, -7.549350576692261],
                  [-78.52901492711953, -7.549329305013267],
                  [-78.5292616903489, -7.549403755885149]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.53413355442224, -7.549302715413056],
                  [-78.53381705375848, -7.549350576692261],
                  [-78.53342008682428, -7.54933462293311],
                  [-78.53362393470941, -7.548808148551122],
                  [-78.53429985138116, -7.549121906088286]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.50347995387332, -7.554189976381904],
                  [-78.50401103125827, -7.553945354749467],
                  [-78.50442409144657, -7.554014486963984],
                  [-78.50478350745456, -7.5540357584123745],
                  [-78.50478887187259, -7.554216565681438],
                  [-78.50435971843021, -7.554296333570218],
                  [-78.5037106238486, -7.554445233589841],
                  [-78.50338339434879, -7.554322922863186]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.49501378481943, -7.553824352512497],
                  [-78.49479384368021, -7.554074292074984],
                  [-78.49458463137705, -7.5540636563518575],
                  [-78.4943056816395, -7.553930709790795],
                  [-78.49465973322947, -7.55379776318883],
                  [-78.49505670016367, -7.553499962651991]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.48953564282114, -7.552845656658405],
                  [-78.48962683792764, -7.553002533990057],
                  [-78.48977435942346, -7.553154093391967],
                  [-78.4899057876652, -7.553318947417908],
                  [-78.49004258032495, -7.553332242094672],
                  [-78.4901579153126, -7.5533774439926304],
                  [-78.49022765274698, -7.553473165643282],
                  [-78.49023569937403, -7.553640678480904],
                  [-78.49023301716501, -7.553755012602632],
                  [-78.49013645764047, -7.553755012602632],
                  [-78.4901230465954, -7.553640678480904],
                  [-78.48991651650125, -7.553409351211868],
                  [-78.48972071524317, -7.553287040191992],
                  [-78.48953296061212, -7.553265768706733],
                  [-78.48935593481714, -7.553170047010141],
                  [-78.48931838389093, -7.552970626740769],
                  [-78.48944981213266, -7.552803113643398]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.47481230750756, -7.5392302912902585],
                  [-78.47439924731927, -7.539012251430533],
                  [-78.4737555171557, -7.538342177027992],
                  [-78.47394863620477, -7.538182635350735],
                  [-78.47472647681909, -7.538703804612144]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.47276351113167, -7.537285749546479],
                  [-78.47270450253335, -7.537482518014226],
                  [-78.47234508652535, -7.537408065090988],
                  [-78.47205540795174, -7.5369666653546625],
                  [-78.47229144234505, -7.536743306280506]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.46225926721397, -7.5304484766950655],
                  [-78.46182474935355, -7.530225114260411],
                  [-78.46183547818961, -7.5299219793435554],
                  [-78.46230754697623, -7.530177250866584]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.46010431032722, -7.5279737546957834],
                  [-78.45985754709785, -7.527713163689872],
                  [-78.45999702196663, -7.52763339090164],
                  [-78.46022769194191, -7.5278301637527125]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.4592352746064, -7.526043250261161],
                  [-78.45935329180305, -7.526399569908251],
                  [-78.4591440794999, -7.526479342923448],
                  [-78.45905824881142, -7.526101750521816]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.45635107078719, -7.522226990687773],
                  [-78.45663002052474, -7.522785406857659],
                  [-78.45637252845931, -7.522827952822096],
                  [-78.45616868057418, -7.52228549146308]]]),
            {
              "system:index": "11"
            })]),
    cultivos = /* color: #a9ff7e */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.50605299090698, -7.553904106009102],
                  [-78.50602616881683, -7.554175316966964],
                  [-78.50594033812835, -7.5542550848633505],
                  [-78.5058223209317, -7.554345488461439],
                  [-78.50575794791534, -7.554223177706554],
                  [-78.50574185466125, -7.5540370525783445],
                  [-78.50566675280884, -7.553866880962385],
                  [-78.50550582026794, -7.553744570072007],
                  [-78.50552727794006, -7.553510583924382],
                  [-78.50565602397278, -7.553398908672897],
                  [-78.50595643138244, -7.55347335884376],
                  [-78.50620319461181, -7.553558444737608]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.48491674933604, -7.540912917826208],
                  [-78.48464316401652, -7.540878350673075],
                  [-78.48416573081187, -7.540817193395371],
                  [-78.48416841302088, -7.540514065891359],
                  [-78.48448759589365, -7.540444931518618],
                  [-78.48489529166392, -7.5405991543349815]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.47277386729039, -7.538966812603932],
                  [-78.4724520022086, -7.539315144559102],
                  [-78.47210599724568, -7.539232714885088],
                  [-78.4722910696677, -7.538921609199892],
                  [-78.47250832859791, -7.538849815548486]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.47204698864735, -7.538461597819791],
                  [-78.47163392845906, -7.538227603404213],
                  [-78.47173585240162, -7.5380228581868485],
                  [-78.472165005844, -7.538235580488653]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-78.4635432625793, -7.5406315389733765],
                  [-78.4628244305633, -7.54108888903698],
                  [-78.46297999868617, -7.540450726024237],
                  [-78.46343060980067, -7.540503906311238]]]),
            {
              "system:index": "4"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
/**** SERNANP - COLECTA DE MUESTRAS ANP HUASCARN ****/ //CAMBIAR TTLO SEGN ANP

// === Importar mdulo con utilidades Planet ===
var mosaic = require('users/ryali93/lulc:UTILES/planet.js'); // usa funcin getPlanetMonthlyImage()

//----------------------------------------------------
// 1. PARMETROS GENERALES
//----------------------------------------------------
var version = '1';
var year = 2023;
var regionId = 'CC02';
var region = 'SUNCHUBAMBA';// Cambiar cdigo segn ANP
var tipo_muestra = 'MultiClass';  // 'MultiClass' o 'Urban_mining'

//----------------------------------------------------
// 2. CAPAS BASE
//----------------------------------------------------
var area_anp = ee.FeatureCollection(
  'projects/royyali/assets/anps_grupo2'
).filter(ee.Filter.eq('codigo', regionId));

var area_trabajo = ee.FeatureCollection('projects/ee-teledetecciondde/assets/Shp_ANP_ZA_ZR_ACR_ACP_Dissolve').filter(ee.Filter.eq('CODIGO', regionId));

var MapBiomas = ee.Image('projects/mapbiomas-public/assets/peru/collection3/mapbiomas_peru_collection3_integration_v1')
  .select('classification_' + year);

var WorldCover = ee.ImageCollection('ESA/WorldCover/v200').first().select('Map');

//----------------------------------------------------
// 3. COLORES Y CLASES
//----------------------------------------------------
var MB_COLORS = {
  1:'#1f8d49',3:'#1f8d49',4:'#76c975',5:'#04381d',6:'#026975',
  9:'#7a5900',10:'#b6db74',11:'#519769',12:'#dbbc74',13:'#b6db74',
  15:'#edd88e',18:'#e97e4d',21:'#ffcf63',22:'#d4271e',23:'#ffa07a',
  24:'#d4271e',25:'#db4b4b',27:'#ffffff',29:'#a3b58e',30:'#9c0027',
  31:'#091077',32:'#f5d1d5',33:'#2532e4',34:'#93d6f6',35:'#9056d0',
  40:'#c71585',61:'#dcdcdc',66:'#a39358',68:'#f9a47a',70:'#fbe9e0',
  72:'#f1d5ae'
};

var MB_CLASSES = {
  3:'Bosque',4:'Bosque seco',5:'Manglar',6:'Bosque inundable',
  9:'Plantacin forestal',11:'Zona pantanosa/pastizal inun.',
  12:'Pastizal/herbazal',13:'Otra no boscosa',15:'Pasto',
  18:'Agricultura',21:'Mosaico agropecuario',23:'Playa',
  24:'Infraestructura urbana',25:'Otra rea sin veg.',
  29:'Afloramiento rocoso',30:'Minera',31:'Acuicultura',
  32:'Salina costera',33:'Ro/lago/ocano',34:'Glaciar',
  35:'Palma aceitera',40:'Arroz',61:'Salar',66:'Matorral',
  68:'rea natural sin veg.',70:'Loma costera',72:'Otros cultivos',
  27:'No observado'
};

var WC_CLASSES = {
  10:'Bosque',20:'Matorrales',30:'Pastizales',40:'Cultivos',
  50:'Construcciones',60:'Escasa vegetacin',70:'Nieve/hielo',
  80:'Agua',90:'Humedales herbceos',95:'Manglares',100:'Musgo/lquenes'
};

var WC_COLOR_TABLE = {
  10:'#006400',20:'#ffbb22',30:'#ffff4c',40:'#f096ff',
  50:'#fa0000',60:'#b4b4b4',70:'#f0f0f0',80:'#0064c8',
  90:'#0096a0',95:'#00cf75',100:'#fae6a0'
};

//----------------------------------------------------
// 4. PANEL DE CONTROL
//----------------------------------------------------
var controlPanel = ui.Panel({style: {position: 'top-left', padding: '8px'}});

controlPanel.add(ui.Label({
  value: 'COLECTA DE MUESTRAS -' + region,
  style: {fontWeight: 'bold', width:'150px',fontSize: '16px', margin: '0 0 4px 0'}
}));

var monthSelect = ui.Select({
  items: [
    {label: 'Enero', value: 1},{label: 'Febrero', value: 2},{label: 'Marzo', value: 3},
    {label: 'Abril', value: 4},{label: 'Mayo', value: 5},{label: 'Junio', value: 6},
    {label: 'Julio', value: 7},{label: 'Agosto', value: 8},{label: 'Septiembre', value: 9},
    {label: 'Octubre', value: 10},{label: 'Noviembre', value: 11},{label: 'Diciembre', value: 12}
  ],
  value: 6,
  onChange: updateLayer
});
controlPanel.add(ui.Label('Selecciona mes:'));
controlPanel.add(monthSelect);

ui.root.insert(0, controlPanel);

// Panel leyendas (se usarn dos: una para MapBiomas, otra para WorldCover)
var legendPanel = ui.Panel({style:{position:'bottom-left', padding:'8px'}});
ui.root.add(legendPanel);

//----------------------------------------------------
// 5. FUNCIONES AUXILIARES
//----------------------------------------------------
function sortNumericArray(arrStr) {
  return arrStr.map(function(s){ return parseInt(s,10); }).sort(function(a,b){return a-b;});
}

function prepareRemapAndPalette(image, geom, bandName, colorDict, classNamesDict, callback) {
  var freq = image.reduceRegion({
    reducer: ee.Reducer.frequencyHistogram(),
    geometry: geom,
    scale: 30,
    maxPixels: 1e13
  }).get(bandName);

  ee.Dictionary(freq).keys().evaluate(function(classKeys) {
    if (!classKeys || !classKeys.length) { callback(null); return; }

    var origIds = sortNumericArray(classKeys);
    var palette = [], from = [], to = [], names = [];
    for (var i = 0; i < origIds.length; i++) {
      var id = origIds[i];
      from.push(id); to.push(i + 1);
      palette.push(colorDict[id] || '#FFFFFF');
      names.push(classNamesDict[id] || ('Clase ' + id));
    }
    var remapped = image.remap(from, to).rename('remap');
    callback({remappedImage: remapped, palette: palette, origIds: origIds, names: names});
  });
}

function drawLegend(origIds, names, palette, title) {
  var p = ui.Panel({style:{padding:'8px 12px', backgroundColor:'rgba(255,255,255,0.9)', margin:'4px'}});
  p.add(ui.Label({value: title, style:{fontWeight:'bold', fontSize:'14px', margin:'0 0 6px 0'}}));

  var grid = ui.Panel({layout: ui.Panel.Layout.Flow('horizontal')});
  var col1 = ui.Panel({layout: ui.Panel.Layout.Flow('vertical'), style:{padding:'0 8px'}});
  var col2 = ui.Panel({layout: ui.Panel.Layout.Flow('vertical'), style:{padding:'0 8px'}});

  for (var i = 0; i < origIds.length; i++) {
    var color = palette[i];
    var name = names[i];
    var row = ui.Panel({
      layout: ui.Panel.Layout.Flow('horizontal'),
      widgets: [
        ui.Label('', {backgroundColor: color, padding: '6px', margin: '0 8px 6px 0', border: '1px solid #999'}),
        ui.Label(origIds[i] + '  ' + name, {fontSize: '12px', margin: '0 0 6px 0'})
      ]
    });
    if (i % 2 === 0) col1.add(row); else col2.add(row);
  }
  grid.add(col1); grid.add(col2); p.add(grid);
  legendPanel.add(p);
}

//----------------------------------------------------
// 6. FUNCIN PRINCIPAL: CARGA AMBAS REFERENCIAS
//----------------------------------------------------
function updateLayer() {
  Map.layers().reset();
  legendPanel.clear();

  var month = parseInt(monthSelect.getValue());
  var planetImage = mosaic.getPlanetMonthlyImage(year, month, area_trabajo.geometry());
  var rgbVis = {bands: ['R','G','B'], min: 0, max: 80, gamma: 1.6};
  Map.addLayer(planetImage, rgbVis, 'Planet ' + year + ' M' + month, true);

  Map.addLayer(planetImage.select('NDVI'),
    {min: 0.0, max: 0.8, palette: ['#a50026','#d73027','#f46d43','#fdae61','#fee08b','#d9ef8b','#a6d96a','#1a9850','#006837']},
    'NDVI ' + year + ' M' + month, false);

  Map.addLayer(planetImage.select('NDWI'),
    {min: -1, max: 1, palette: ['#ffeda0', '#253494', '#2c7fb8']},
    'NDWI ' + year + ' M' + month, false);

  var ndsi = planetImage.normalizedDifference(['G','N']).rename('NDSI');
  Map.addLayer(ndsi, {min: -0.5, max: 1.0, palette: ['#0000ff', '#00ffff', '#ffffff']}, 'NDSI', false);

  // --- Aadir MapBiomas ---
  prepareRemapAndPalette(MapBiomas.clip(area_trabajo), area_trabajo.geometry(), 'classification_' + year,
    MB_COLORS, MB_CLASSES, function(result) {
      if (result) {
        Map.addLayer(result.remappedImage.clip(area_trabajo),
          {min: 1, max: result.palette.length, palette: result.palette},
          'MapBiomas Per C3 (' + year + ')', true);
        drawLegend(result.origIds, result.names, result.palette, 'MapBiomas C3 (' + year + ')');
      } else {
        ui.alert('No se encontraron clases MapBiomas en el rea.');
      }
    });

  // --- Aadir WorldCover ---
  prepareRemapAndPalette(WorldCover.clip(area_trabajo), area_trabajo.geometry(), 'Map',
    WC_COLOR_TABLE, WC_CLASSES, function(result) {
      if (result) {
        Map.addLayer(result.remappedImage.clip(area_trabajo),
          {min: 1, max: result.palette.length, palette: result.palette},
          'WorldCover (2021)', true);
        drawLegend(result.origIds, result.names, result.palette, 'WorldCover (2021)');
      } else {
        ui.alert('No se encontraron clases WorldCover en el rea.');
      }
    });

  // --- Lmite ANP ---
  
Map.addLayer(area_trabajo.style({color: 'cyan', fillColor: '00000000'}), {}, 'Lmite ANP + ZA', true);
  Map.addLayer(area_anp.style({color: 'red', fillColor: '00000000'}), {}, 'Lmite ANP', true);
}
  Map.centerObject(area_trabajo)

// Carga inicial
updateLayer();


//----------------------------------------------------
// 7. EXPORTAR MUESTRAS MANUALES
//----------------------------------------------------

// (al terminar de dibujar tus polgonos de muestra)
// var list_geom = ee.FeatureCollection([Bosque, Pastizal, Urbano, Mineria]).flatten();

// Export.table.toAsset({
//   collection: list_geom,
//   description: tipo_muestra + '-' + year + '-draw-' + version,
//   assetId: 'projects/ee-anp-lineabase/assets/AUXILIAR-DATA/geometry/' +
//             tipo_muestra + '-' + year + '-draw-' + version
// });
