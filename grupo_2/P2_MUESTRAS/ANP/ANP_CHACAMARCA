/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var pajonal = /* color: #d63000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96161832575547, -11.213145971643929],
                  [-75.96201529268967, -11.213019683272742],
                  [-75.96234788660752, -11.21303020730578],
                  [-75.96241225962387, -11.21328278398378],
                  [-75.9618758178209, -11.213851080702238],
                  [-75.96154322390305, -11.214303612475096],
                  [-75.96063127283799, -11.214324660447296],
                  [-75.9602557635759, -11.214114180656406],
                  [-75.9602021193956, -11.213682696605868],
                  [-75.9603630519365, -11.213377500181126],
                  [-75.96111407046067, -11.213251211911105]]]),
            {
              "clase": 28,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.99367330154689, -11.231387521333245],
                  [-75.99330852112087, -11.231871595665039],
                  [-75.99283645233425, -11.232166249208497],
                  [-75.99260041794093, -11.231997875791949],
                  [-75.99298665603908, -11.231187577350493]]]),
            {
              "clase": 28,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96339602090102, -11.234740489843043],
                  [-75.96346039391737, -11.235214035324544],
                  [-75.96255917168837, -11.235708626441834],
                  [-75.96172232247572, -11.234950954597478],
                  [-75.96229095078688, -11.23455107143277]]]),
            {
              "clase": 28,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.947603011745, -11.234401215462414],
                  [-75.94764592708924, -11.234653773446363],
                  [-75.94740989269593, -11.23473795939187],
                  [-75.94727041782716, -11.234706389665169],
                  [-75.94700219692567, -11.234390692208281]]]),
            {
              "clase": 28,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.95113071139346, -11.236415935472145],
                  [-75.9506157272626, -11.236121286269544],
                  [-75.95089467700015, -11.235510940535152],
                  [-75.95171006854068, -11.23595291516148]]]),
            {
              "clase": 28,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.94867883085207, -11.228005500166727],
                  [-75.9484481608768, -11.228331728085445],
                  [-75.94801900743441, -11.228068641082992],
                  [-75.9480887448688, -11.22777398335555],
                  [-75.9484320676227, -11.227863433054605]]]),
            {
              "clase": 28,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-76.0026540028916, -11.228045550127561],
                  [-76.00195662854773, -11.229234701565963],
                  [-76.00098030446631, -11.228866380847755],
                  [-76.0018600690232, -11.227845603829316]]]),
            {
              "clase": 28,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.95825491312151, -11.222389062138722],
                  [-75.95720348718767, -11.222473251661869],
                  [-75.95719275835161, -11.22156821300188],
                  [-75.95861969354753, -11.221841829640072]]]),
            {
              "clase": 28,
              "system:index": "7"
            })]),
    bofedal = /* color: #98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.98678997131103, -11.199659545994223],
                  [-75.98657539458983, -11.199985805912503],
                  [-75.98599603744262, -11.199670070513454],
                  [-75.98629644485229, -11.199038598681879],
                  [-75.98681142898315, -11.199270138513455]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.98397901626342, -11.198880730508682],
                  [-75.98380735488647, -11.199091221387135],
                  [-75.98343184562438, -11.199070172306183],
                  [-75.9835605916571, -11.198470272855317],
                  [-75.98394682975524, -11.19852289566393]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.98219055148074, -11.197507378671984],
                  [-75.98210472077668, -11.198138853959485],
                  [-75.9818257709884, -11.198244099706784],
                  [-75.98119276954579, -11.198223050560385],
                  [-75.9811069388417, -11.198002034430779],
                  [-75.98161119422818, -11.19778101813239],
                  [-75.9818364998264, -11.197549477067344]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.9929581247132, -11.198949662587966],
                  [-75.99218564851691, -11.199539036521431],
                  [-75.99160629136969, -11.199286447839787],
                  [-75.99179941041876, -11.198339238320044],
                  [-75.99304395540167, -11.198381336586754]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-76.00076872087301, -11.199917919707744],
                  [-75.99993186997327, -11.200538868767499],
                  [-75.99884825265259, -11.200665161509608],
                  [-75.99911647381131, -11.199696901998422],
                  [-76.00013571892187, -11.199517986467203]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-76.00272835235471, -11.20474328785538],
                  [-76.00236357192868, -11.205059017717732],
                  [-76.00169838409299, -11.204648568829468],
                  [-76.00173057060117, -11.203869766773794],
                  [-76.0028356407153, -11.20410130273911]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.9814719801565, -11.21980617946293],
                  [-75.98089262319924, -11.220332368113228],
                  [-75.97964807862445, -11.2201008452252],
                  [-75.97966953628949, -11.218480179812762],
                  [-75.98102136918976, -11.218816942205315]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.99052711813862, -11.21554401470979],
                  [-75.99048420279438, -11.216238594001014],
                  [-75.98951860754902, -11.216280689661973],
                  [-75.98956152289325, -11.215144104663505]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.97852562509512, -11.20423875726673],
                  [-75.97833250604604, -11.204786023097032],
                  [-75.97766731821035, -11.205691114313208],
                  [-75.97732399545644, -11.204849169087742],
                  [-75.97798918329214, -11.203923026509013]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.94393374981263, -11.23563243354541],
                  [-75.94331147732117, -11.23532726032243],
                  [-75.94309690059998, -11.235127319070225],
                  [-75.94359042705872, -11.23489580797346],
                  [-75.94415905536988, -11.235432492504762]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.94147780249587, -11.23052355828346],
                  [-75.94073751280776, -11.230618268826298],
                  [-75.94040491888991, -11.230534081678643],
                  [-75.94039419005385, -11.230207856249484],
                  [-75.94111302206984, -11.229902677288338]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-76.00084088712335, -11.196556245258689],
                  [-75.99620602994561, -11.195882668009219],
                  [-75.99646352201104, -11.193777729002969],
                  [-76.00084088712335, -11.193693531124403]]]),
            {
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.94597964563803, -11.23907350983444],
                  [-75.94505696573691, -11.23932606372667],
                  [-75.94490676203208, -11.23875781715808],
                  [-75.9458294419332, -11.238463170348313]]]),
            {
              "system:index": "12"
            })]),
    urbano = /* color: #0b4a8b */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-76.00241159808743, -11.208421063788217],
                  [-76.0025671662103, -11.2084105395874],
                  [-76.00261544597257, -11.20843948113878],
                  [-76.00255375516522, -11.20851315052923],
                  [-76.00235795390714, -11.208526305775539],
                  [-76.00220506799329, -11.208539461021262],
                  [-76.00197171580899, -11.208581557803546],
                  [-76.00149964702237, -11.208678906589101],
                  [-76.0011992396127, -11.208702586018468],
                  [-76.00120192182172, -11.208615761434634],
                  [-76.00129848134625, -11.20856050941318],
                  [-76.00149696481336, -11.208565771510917],
                  [-76.00181882989514, -11.20855261626639],
                  [-76.00226944100964, -11.208450005338566]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.99511174446461, -11.20956951490294],
                  [-75.9952191289826, -11.209555978019011],
                  [-75.99524183160183, -11.209607664976238],
                  [-75.99507017022488, -11.20962608225119],
                  [-75.9949306953561, -11.209657654719823],
                  [-75.99482608920452, -11.209691858223614],
                  [-75.99457664376614, -11.209849720496361],
                  [-75.9944988597047, -11.209862875681871],
                  [-75.99450422412274, -11.209820779086147],
                  [-75.99473757630703, -11.209689227185006],
                  [-75.9950192082536, -11.209547151064546]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.97819280967406, -11.214971754714357],
                  [-75.97842616185835, -11.215213805742328],
                  [-75.97845834836653, -11.21530852130678],
                  [-75.97857368335417, -11.215474273469848],
                  [-75.97857368335417, -11.215576881904115],
                  [-75.97834837779692, -11.215679490301946],
                  [-75.97818744525603, -11.215563726978685],
                  [-75.97813916549376, -11.215440070650333],
                  [-75.97817671641997, -11.21531904525646],
                  [-75.97814989432982, -11.215255901552581],
                  [-75.97799969062498, -11.21517170992594],
                  [-75.97811234340361, -11.214974385704886]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.97315389880745, -11.213543723766124],
                  [-75.97366888293831, -11.213843658013756],
                  [-75.97387273082344, -11.213964684025537],
                  [-75.97395319709389, -11.21377525198468],
                  [-75.97413022288887, -11.213827872008487],
                  [-75.974151680561, -11.214048876003831],
                  [-75.97417313823311, -11.214154115942213],
                  [-75.97401757011025, -11.214175163925288],
                  [-75.97387273082344, -11.21413306795761],
                  [-75.97378153571694, -11.214448787565802],
                  [-75.97409267196267, -11.214711886975817],
                  [-75.97391564616768, -11.21496446218406],
                  [-75.97370643386452, -11.214901318402699],
                  [-75.97355623015969, -11.214790816752101],
                  [-75.97340602645485, -11.215164417400693],
                  [-75.97325582275002, -11.215474873910214],
                  [-75.97305197486489, -11.215706400581556],
                  [-75.9729822374305, -11.215648518931104],
                  [-75.97315926322548, -11.21531701470977],
                  [-75.97330410251229, -11.214990772088886],
                  [-75.97344894179909, -11.214738196903633],
                  [-75.97360450992196, -11.214559289347184],
                  [-75.97375471362679, -11.214244487855872],
                  [-75.97377617129891, -11.213997174017223],
                  [-75.973432848545, -11.213839314009551],
                  [-75.97322900065987, -11.213670929906312],
                  [-75.97297150859444, -11.213562929410305],
                  [-75.9726764656028, -11.213436641221312],
                  [-75.97245116004555, -11.213299828954296],
                  [-75.9722794986686, -11.213268256883477],
                  [-75.97220439681618, -11.213131444536742],
                  [-75.97233850726693, -11.21305251430724],
                  [-75.9724243379554, -11.213063038339095],
                  [-75.9724779821357, -11.213220898770771]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96412984074219, -11.204496135429373],
                  [-75.96455899418457, -11.204906584533942],
                  [-75.96501228750809, -11.2054091207855],
                  [-75.96501228750809, -11.205461742332018],
                  [-75.96496400774582, -11.205472266640172],
                  [-75.96488354147537, -11.205411751863052],
                  [-75.96404937447174, -11.204538232800237]]]),
            {
              "system:index": "4"
            })]),
    afloramiento_rocoso = /* color: #d6d2ae */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.99287673323566, -11.206832790498492],
                  [-75.99290355532581, -11.206916984553866],
                  [-75.99287136881763, -11.20701696496277],
                  [-75.9927748092931, -11.207043275590943],
                  [-75.99271580069477, -11.206938033063869],
                  [-75.9927211651128, -11.206848576885747]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.99355264990741, -11.20618817894983],
                  [-75.99352046339924, -11.206243431424593],
                  [-75.9934426793378, -11.206280266401887],
                  [-75.99340244620258, -11.206264479983629],
                  [-75.99335953085834, -11.206211858583162],
                  [-75.9933890351575, -11.206130295393526],
                  [-75.99355264990741, -11.206138188606433]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.99260851233417, -11.206956450508867],
                  [-75.99262997000629, -11.20712483852308],
                  [-75.99255486815387, -11.20728270219736],
                  [-75.99242075770313, -11.207277440076277],
                  [-75.99238857119495, -11.20712483852308],
                  [-75.99247976630146, -11.206930139872792]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.99678870129597, -11.203618377789487],
                  [-75.99677797245991, -11.203713097152743],
                  [-75.9966492264272, -11.203844651772469],
                  [-75.99651511597645, -11.20370257278057],
                  [-75.99662776875508, -11.203444725542964],
                  [-75.99673505711567, -11.203413152396024]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.98887575183342, -11.233481479047652],
                  [-75.98902059112022, -11.233397292735454],
                  [-75.98924589667747, -11.233197350145518],
                  [-75.98935318503807, -11.233060547240974],
                  [-75.98940146480034, -11.233107902099894],
                  [-75.98939073596428, -11.233197350145518],
                  [-75.98921907458733, -11.233344676277861],
                  [-75.98892939601372, -11.233581450261482],
                  [-75.9887630990548, -11.233744561114943],
                  [-75.9886021665139, -11.233928718419277],
                  [-75.9884573272271, -11.234181276816912],
                  [-75.98830712352226, -11.234244416381758],
                  [-75.98825347934196, -11.234118137238235],
                  [-75.98841441188286, -11.234054997645734],
                  [-75.98863435302208, -11.233781392585206],
                  [-75.98873627696464, -11.233618281752587]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.98905013647568, -11.20864979421498],
                  [-75.98895089474213, -11.208534028076265],
                  [-75.98883287754548, -11.208412999790783],
                  [-75.98884897079957, -11.208352485629048],
                  [-75.9889643057872, -11.208402475589645],
                  [-75.98902867880356, -11.208536659125382],
                  [-75.98913060274613, -11.208599804297126]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.99744356953141, -11.202836891809067],
                  [-75.99701441608903, -11.203068428601101],
                  [-75.99677838169572, -11.202963184627688],
                  [-75.99679983936784, -11.202626403655495],
                  [-75.9972075351381, -11.202636928066804]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.9971538909578, -11.20408450495334],
                  [-75.99706806026933, -11.204431808573986],
                  [-75.99643505894181, -11.20463177107549],
                  [-75.9963599570894, -11.20433708944608],
                  [-75.99643505894181, -11.20398978571171],
                  [-75.99698222958085, -11.203653005934692]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.98379272592359, -11.22684589779318],
                  [-75.98406094682508, -11.22655123881751],
                  [-75.98422187936598, -11.226409170989623],
                  [-75.98430771005445, -11.226503882882644],
                  [-75.98425943029218, -11.226619641820811],
                  [-75.98425943029218, -11.226835374263521],
                  [-75.98462957513624, -11.226987965406126],
                  [-75.98472077024275, -11.22725105339361],
                  [-75.98459202421003, -11.227272100422253],
                  [-75.9842433370381, -11.227208959331719],
                  [-75.98381418359571, -11.227240529878708],
                  [-75.98353523385816, -11.227319456231076],
                  [-75.98340648782545, -11.227629899674307],
                  [-75.9831275380879, -11.22776144340547],
                  [-75.98303097856336, -11.227645684925212],
                  [-75.98338503015333, -11.227193174056934],
                  [-75.98363715780073, -11.226972180119253]]]),
            {
              "system:index": "8"
            })]),
    mineria = /* color: #293dff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96149831648437, -11.200905166472909],
                  [-75.96148490543929, -11.201055140190253],
                  [-75.9612891041812, -11.201286678408241],
                  [-75.9612703287181, -11.201215638292885],
                  [-75.96126228209106, -11.200928846538694],
                  [-75.96139907475082, -11.200807815070915]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96197622235515, -11.202531162019717],
                  [-75.96196012910106, -11.202646930561238],
                  [-75.96199768002727, -11.20275743685313],
                  [-75.96183674748637, -11.202946876112422],
                  [-75.96171336587169, -11.203010022504623],
                  [-75.96172409470775, -11.202888991907463],
                  [-75.96182065423228, -11.202741650242588],
                  [-75.96172945912578, -11.202652192766582],
                  [-75.9618045609782, -11.202546948641738],
                  [-75.96187966283061, -11.202346984699073]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96280234273173, -11.202504850981088],
                  [-75.96293108876445, -11.202362771331153],
                  [-75.96305983479716, -11.202357509120558],
                  [-75.9629954617808, -11.202483802148459],
                  [-75.96288280900218, -11.202515375396821],
                  [-75.96277015622356, -11.202673241586945],
                  [-75.96264677460887, -11.202773223462808],
                  [-75.96253948624828, -11.20275217464971],
                  [-75.96250193532207, -11.202625881738967],
                  [-75.96268968995311, -11.202483802148459]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.9614276846346, -11.20491203172766],
                  [-75.9614276846346, -11.205001488504784],
                  [-75.9614276846346, -11.205185664135296],
                  [-75.9613364895281, -11.205390888271133],
                  [-75.96123993000356, -11.205548752891916],
                  [-75.96100926002828, -11.205417199047252],
                  [-75.9612292011675, -11.205211974930082],
                  [-75.9612667520937, -11.205096207415115],
                  [-75.96131503185597, -11.204954129037977]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.9630316456255, -11.204627874722654],
                  [-75.96297263702718, -11.204738380257764],
                  [-75.96284389099446, -11.204848885750662],
                  [-75.96276342472402, -11.204791001926324],
                  [-75.9627795179781, -11.20466470990572],
                  [-75.96287071308461, -11.204575253024425]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96173653889798, -11.203216674710653],
                  [-75.96175263215207, -11.203271927753054],
                  [-75.96172044564389, -11.203364016133603],
                  [-75.96164266158246, -11.203356122844983],
                  [-75.96162120391034, -11.203279821043962],
                  [-75.9616507082095, -11.203208781418015]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.95787628555686, -11.21013168496217],
                  [-75.9572164621392, -11.211147262531846],
                  [-75.95711453819663, -11.211042021498617],
                  [-75.95716818237693, -11.210894683987735],
                  [-75.95774217510612, -11.209936988336608]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.95143459706902, -11.216452376757736],
                  [-75.95126293569207, -11.217273240432753],
                  [-75.95083378224969, -11.217410050818511],
                  [-75.9509088841021, -11.216831237205236],
                  [-75.95100544362664, -11.216504996294056]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.94813011556268, -11.21710485833058],
                  [-75.94821594625115, -11.217262716554242],
                  [-75.94817303090691, -11.217410050818511],
                  [-75.9479906406939, -11.217378479196773],
                  [-75.9477009621203, -11.217283764310887],
                  [-75.94803355603814, -11.21691542834833]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.948786355969, -11.22216114976686],
                  [-75.94771347236305, -11.2213823948997],
                  [-75.94762764167457, -11.220814112995644],
                  [-75.94893655967384, -11.22155077450837]]]),
            {
              "system:index": "9"
            })]),
    mineria_9 = /* color: #bf39d2 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96182521875218, -11.20416582515889],
                  [-75.96175011689976, -11.204292117397316],
                  [-75.9616481929572, -11.204271068694748],
                  [-75.96165892179326, -11.204128989912292],
                  [-75.961793032244, -11.203986911060056]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96165355737523, -11.204539439537859],
                  [-75.96151944692448, -11.204676255950274],
                  [-75.96143898065404, -11.204571012561853],
                  [-75.96161600644902, -11.20443945827247]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.96202264424021, -11.202537364179946],
                  [-75.96201191540415, -11.202711016971131],
                  [-75.96201191540415, -11.202810998833945],
                  [-75.96181343193705, -11.202974127062213],
                  [-75.9616793214863, -11.202937291663874],
                  [-75.96177051659281, -11.202768901211716],
                  [-75.96182952519113, -11.202626821691448],
                  [-75.9618778049534, -11.202347924652482]]]),
            {
              "system:index": "2"
            })]),
    pasto = /* color: #00ffff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.97916548064401, -11.21397913901838],
                  [-75.97901527693918, -11.214368526692944],
                  [-75.97889725974252, -11.214652674124315],
                  [-75.97897236159494, -11.215042060891314],
                  [-75.9789294462507, -11.215410399242035],
                  [-75.97873632720163, -11.21530515976117],
                  [-75.97869341185739, -11.214526386411526],
                  [-75.97890798857858, -11.214347478723939],
                  [-75.97895090392282, -11.21413699894968],
                  [-75.97880070021799, -11.213884423018218],
                  [-75.97856466582468, -11.213852851011263],
                  [-75.97866122534921, -11.213716038941275],
                  [-75.97867195418527, -11.213400318532562],
                  [-75.97885434439829, -11.2133056023427]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.97819452098062, -11.215710331552227],
                  [-75.9781194191282, -11.216204956085443],
                  [-75.97784583380869, -11.216168122372785],
                  [-75.97784046939066, -11.215852404643117],
                  [-75.97744350245645, -11.215757689256941],
                  [-75.9774703245466, -11.21547354291215]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.93645564427696, -11.238446958133194],
                  [-75.93529692998253, -11.238383819488366],
                  [-75.93533984532677, -11.236868487865394],
                  [-75.93652001729332, -11.237226275216678]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.93918366443391, -11.224665364250773],
                  [-75.93911929141755, -11.225149449857227],
                  [-75.93834681522127, -11.22504421392487],
                  [-75.9380464078116, -11.224307561324336]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-75.95336259553078, -11.202028876609603],
                  [-75.95269740769508, -11.201628947869901],
                  [-75.9531694764817, -11.200681746018095],
                  [-75.95379174897316, -11.200976431370941]]]),
            {
              "system:index": "4"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
/**** SERNANP - COLECTA DE MUESTRAS ANP HUASCARÁN ****/ //CAMBIAR TÍTLO SEGÚN ANP

// === Importar módulo con utilidades Planet ===
var mosaic = require('users/ryali93/lulc:UTILES/planet.js'); // usa función getPlanetMonthlyImage()

//----------------------------------------------------
// 1. PARÁMETROS GENERALES
//----------------------------------------------------
var version = '1';
var year = 2023;
var regionId = 'SH01';
var region = 'CHACAMARCA';// Cambiar código según ANP
var tipo_muestra = 'MultiClass';  // 'MultiClass' o 'Urban_mining'

//----------------------------------------------------
// 2. CAPAS BASE
//----------------------------------------------------
var area_anp = ee.FeatureCollection(
  'projects/royyali/assets/anps_grupo2'
).filter(ee.Filter.eq('codigo', regionId));

var area_trabajo = ee.FeatureCollection('projects/ee-teledetecciondde/assets/Shp_ANP_ZA_ZR_ACR_ACP_Dissolve')
.filter(ee.Filter.eq('CODIGO', regionId));

var MapBiomas = ee.Image('projects/mapbiomas-public/assets/peru/collection3/mapbiomas_peru_collection3_integration_v1')
  .select('classification_' + year);

var WorldCover = ee.ImageCollection('ESA/WorldCover/v200').first().select('Map');

//----------------------------------------------------
// 3. COLORES Y CLASES
//----------------------------------------------------
var MB_COLORS = {
  1:'#1f8d49',3:'#1f8d49',4:'#76c975',5:'#04381d',6:'#026975',
  9:'#7a5900',10:'#b6db74',11:'#519769',12:'#dbbc74',13:'#b6db74',
  15:'#edd88e',18:'#e97e4d',21:'#ffcf63',22:'#d4271e',23:'#ffa07a',
  24:'#d4271e',25:'#db4b4b',27:'#ffffff',29:'#a3b58e',30:'#9c0027',
  31:'#091077',32:'#f5d1d5',33:'#2532e4',34:'#93d6f6',35:'#9056d0',
  40:'#c71585',61:'#dcdcdc',66:'#a39358',68:'#f9a47a',70:'#fbe9e0',
  72:'#f1d5ae'
};

var MB_CLASSES = {
  3:'Bosque',4:'Bosque seco',5:'Manglar',6:'Bosque inundable',
  9:'Plantación forestal',11:'Zona pantanosa/pastizal inun.',
  12:'Pastizal/herbazal',13:'Otra no boscosa',15:'Pasto',
  18:'Agricultura',21:'Mosaico agropecuario',23:'Playa',
  24:'Infraestructura urbana',25:'Otra área sin veg.',
  29:'Afloramiento rocoso',30:'Minería',31:'Acuicultura',
  32:'Salina costera',33:'Río/lago/océano',34:'Glaciar',
  35:'Palma aceitera',40:'Arroz',61:'Salar',66:'Matorral',
  68:'Área natural sin veg.',70:'Loma costera',72:'Otros cultivos',
  27:'No observado'
};

var WC_CLASSES = {
  10:'Bosque',20:'Matorrales',30:'Pastizales',40:'Cultivos',
  50:'Construcciones',60:'Escasa vegetación',70:'Nieve/hielo',
  80:'Agua',90:'Humedales herbáceos',95:'Manglares',100:'Musgo/líquenes'
};

var WC_COLOR_TABLE = {
  10:'#006400',20:'#ffbb22',30:'#ffff4c',40:'#f096ff',
  50:'#fa0000',60:'#b4b4b4',70:'#f0f0f0',80:'#0064c8',
  90:'#0096a0',95:'#00cf75',100:'#fae6a0'
};

//----------------------------------------------------
// 4. PANEL DE CONTROL
//----------------------------------------------------
var controlPanel = ui.Panel({style: {position: 'top-left', padding: '8px'}});

controlPanel.add(ui.Label({
  value: 'COLECTA DE MUESTRAS -' + region,
  style: {fontWeight: 'bold',width: '200px', fontSize: '16px', margin: '0 0 4px 0'}
}));

var monthSelect = ui.Select({
  items: [
    {label: 'Enero', value: 1},{label: 'Febrero', value: 2},{label: 'Marzo', value: 3},
    {label: 'Abril', value: 4},{label: 'Mayo', value: 5},{label: 'Junio', value: 6},
    {label: 'Julio', value: 7},{label: 'Agosto', value: 8},{label: 'Septiembre', value: 9},
    {label: 'Octubre', value: 10},{label: 'Noviembre', value: 11},{label: 'Diciembre', value: 12}
  ],
  value: 6,
  onChange: updateLayer
});
controlPanel.add(ui.Label('Selecciona mes:'));
controlPanel.add(monthSelect);

ui.root.insert(0, controlPanel);

// Panel leyendas (se usarán dos: una para MapBiomas, otra para WorldCover)
var legendPanel = ui.Panel({style:{position:'bottom-left', padding:'8px'}});
ui.root.add(legendPanel);

//----------------------------------------------------
// 5. FUNCIONES AUXILIARES
//----------------------------------------------------
function sortNumericArray(arrStr) {
  return arrStr.map(function(s){ return parseInt(s,10); }).sort(function(a,b){return a-b;});
}

function prepareRemapAndPalette(image, geom, bandName, colorDict, classNamesDict, callback) {
  var freq = image.reduceRegion({
    reducer: ee.Reducer.frequencyHistogram(),
    geometry: geom,
    scale: 30,
    maxPixels: 1e13
  }).get(bandName);

  ee.Dictionary(freq).keys().evaluate(function(classKeys) {
    if (!classKeys || !classKeys.length) { callback(null); return; }

    var origIds = sortNumericArray(classKeys);
    var palette = [], from = [], to = [], names = [];
    for (var i = 0; i < origIds.length; i++) {
      var id = origIds[i];
      from.push(id); to.push(i + 1);
      palette.push(colorDict[id] || '#FFFFFF');
      names.push(classNamesDict[id] || ('Clase ' + id));
    }
    var remapped = image.remap(from, to).rename('remap');
    callback({remappedImage: remapped, palette: palette, origIds: origIds, names: names});
  });
}

function drawLegend(origIds, names, palette, title) {
  var p = ui.Panel({style:{padding:'8px 12px', backgroundColor:'rgba(255,255,255,0.9)', margin:'4px'}});
  p.add(ui.Label({value: title, style:{fontWeight:'bold', fontSize:'14px', margin:'0 0 6px 0'}}));

  var grid = ui.Panel({layout: ui.Panel.Layout.Flow('horizontal')});
  var col1 = ui.Panel({layout: ui.Panel.Layout.Flow('vertical'), style:{padding:'0 8px'}});
  var col2 = ui.Panel({layout: ui.Panel.Layout.Flow('vertical'), style:{padding:'0 8px'}});

  for (var i = 0; i < origIds.length; i++) {
    var color = palette[i];
    var name = names[i];
    var row = ui.Panel({
      layout: ui.Panel.Layout.Flow('horizontal'),
      widgets: [
        ui.Label('', {backgroundColor: color, padding: '6px', margin: '0 8px 6px 0', border: '1px solid #999'}),
        ui.Label(origIds[i] + ' – ' + name, {fontSize: '12px', margin: '0 0 6px 0'})
      ]
    });
    if (i % 2 === 0) col1.add(row); else col2.add(row);
  }
  grid.add(col1); grid.add(col2); p.add(grid);
  legendPanel.add(p);
}

//----------------------------------------------------
// 6. FUNCIÓN PRINCIPAL: CARGA AMBAS REFERENCIAS
//----------------------------------------------------
function updateLayer() {
  Map.layers().reset();
  legendPanel.clear();

  var month = parseInt(monthSelect.getValue());
  var planetImage = mosaic.getPlanetMonthlyImage(year, month, area_trabajo.geometry());
  var rgbVis = {bands: ['R','G','B'], min: 0, max: 80, gamma: 1.6};
  Map.addLayer(planetImage, rgbVis, 'Planet ' + year + ' M' + month, true);

  Map.addLayer(planetImage.select('NDVI'),
    {min: 0.0, max: 0.8, palette: ['#a50026','#d73027','#f46d43','#fdae61','#fee08b','#d9ef8b','#a6d96a','#1a9850','#006837']},
    'NDVI ' + year + ' M' + month, false);

  Map.addLayer(planetImage.select('NDWI'),
    {min: -1, max: 1, palette: ['#ffeda0', '#253494', '#2c7fb8']},
    'NDWI ' + year + ' M' + month, false);

  var ndsi = planetImage.normalizedDifference(['G','N']).rename('NDSI');
  Map.addLayer(ndsi, {min: -0.5, max: 1.0, palette: ['#0000ff', '#00ffff', '#ffffff']}, 'NDSI', false);

  // --- Añadir MapBiomas ---
  prepareRemapAndPalette(MapBiomas.clip(area_trabajo), area_trabajo.geometry(), 'classification_' + year,
    MB_COLORS, MB_CLASSES, function(result) {
      if (result) {
        Map.addLayer(result.remappedImage.clip(area_trabajo),
          {min: 1, max: result.palette.length, palette: result.palette},
          'MapBiomas Perú C3 (' + year + ')', true);
        drawLegend(result.origIds, result.names, result.palette, 'MapBiomas C3 (' + year + ')');
      } else {
        ui.alert('No se encontraron clases MapBiomas en el área.');
      }
    });

  // --- Añadir WorldCover ---
  prepareRemapAndPalette(WorldCover.clip(area_trabajo), area_trabajo.geometry(), 'Map',
    WC_COLOR_TABLE, WC_CLASSES, function(result) {
      if (result) {
        Map.addLayer(result.remappedImage.clip(area_trabajo),
          {min: 1, max: result.palette.length, palette: result.palette},
          'WorldCover (2021)', true);
        drawLegend(result.origIds, result.names, result.palette, 'WorldCover (2021)');
      } else {
        ui.alert('No se encontraron clases WorldCover en el área.');
      }
    });

  // --- Límite ANP ---
  Map.addLayer(area_trabajo.style({color: 'cyan', fillColor: '00000000'}), {}, 'Límite ANP + ZA', true);
  Map.addLayer(area_anp.style({color: 'red', fillColor: '00000000'}), {}, 'Límite ANP', true);
}
 Map.centerObject(area_trabajo)
// Carga inicial
updateLayer();


//----------------------------------------------------
// 7. EXPORTAR MUESTRAS MANUALES
//----------------------------------------------------

// (al terminar de dibujar tus polígonos de muestra)
// var list_geom = ee.FeatureCollection([pajonal,
//                                       bofedal,
//                                       urbano,
//                                       afloramiento_rocoso,
//                                       mineria,
//                                       mineria_9,
//                                       pasto]).flatten();
exports.samples =  [pajonal.map(function(f) { return f.set('clase', 28) }),
                      bofedal.map(function(f) { return f.set('clase', 12) }),
                      urbano.map(function(f) { return f.set('clase', 1) }),
                      afloramiento_rocoso.map(function(f) { return f.set('clase', 26) }),
                      mineria.map(function(f) { return f.set('clase', 2) }),
                      mineria_9.map(function(f) { return f.set('clase', 2) }),
                      pasto.map(function(f) { return f.set('clase', 29) })]
                      
// Export.table.toAsset({
//   collection: list_geom,
//   description: tipo_muestra + '-' + year + '-draw-' + version,
//   assetId: 'projects/ee-anp-lineabase/assets/AUXILIAR-DATA/geometry/' +
//             tipo_muestra + '-' + year + '-draw-' + version
// });
