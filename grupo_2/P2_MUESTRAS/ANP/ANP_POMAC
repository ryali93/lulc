/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var c04_bosque_seco = /* color: #98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.7598076128974, -6.447409145366135],
                  [-79.75714686155463, -6.448091447618532],
                  [-79.75354197263862, -6.446641554234662],
                  [-79.75362780332709, -6.444424062217216],
                  [-79.75886347532416, -6.445021080252596]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79748728513862, -6.444424062217216],
                  [-79.79886057615424, -6.447835584381487],
                  [-79.79654314756537, -6.448603173705209],
                  [-79.79199412107612, -6.4461298261681295]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.81053354978705, -6.453293972090343],
                  [-79.8103618884101, -6.4549997061896],
                  [-79.80718615293647, -6.456108430273284],
                  [-79.80469706297065, -6.454658559829329],
                  [-79.80615618467475, -6.452014667746431]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79611399412299, -6.4785527948578565],
                  [-79.79568484068061, -6.482816906210441],
                  [-79.79147913694526, -6.483669724154447],
                  [-79.79156496763373, -6.478979207615172]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.77980616331244, -6.489383567158234],
                  [-79.78272440672065, -6.491941983319388],
                  [-79.78023531675483, -6.493306466623563],
                  [-79.77826121091987, -6.49219782422062]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.77328303098822, -6.50584248379954],
                  [-79.77062227964545, -6.507803873170314],
                  [-79.76830485105658, -6.507718595530823],
                  [-79.76821902036811, -6.505160259614747],
                  [-79.77096560239936, -6.503795808466437]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.73980906248237, -6.506524707057952],
                  [-79.73731997251654, -6.504051643338941],
                  [-79.73817827940131, -6.5009816162748875],
                  [-79.74341395139838, -6.503284138330769]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.77289660871493, -6.518866195097866],
                  [-79.77285369337069, -6.5195057628332584],
                  [-79.77268203199374, -6.520379837418852],
                  [-79.77135165632235, -6.520145329752787],
                  [-79.77133019865023, -6.518930151908121],
                  [-79.77193101346957, -6.518375859281579]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76884129271178, -6.544016882689191],
                  [-79.76918461546569, -6.544997503594755],
                  [-79.76856234297423, -6.545487813325481],
                  [-79.76783278212218, -6.54535990648561],
                  [-79.76746800169616, -6.54418742559369],
                  [-79.76736071333556, -6.543441299956617]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.75049498304992, -6.54130950628143],
                  [-79.74970104918151, -6.542247496619192],
                  [-79.74807026610046, -6.541607957943548],
                  [-79.74781277403503, -6.53994515355606],
                  [-79.75040915236144, -6.540073061782285]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.74178316816955, -6.54017965194582],
                  [-79.7409463189569, -6.541266870315145],
                  [-79.73940136656432, -6.540563376346257],
                  [-79.73873617872863, -6.539113749287621],
                  [-79.74056008085876, -6.538985840815883]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.7943557276859, -6.507606017993494],
                  [-79.79347596312901, -6.506348170847606],
                  [-79.79317555571934, -6.505495391330181],
                  [-79.79450593139073, -6.505601988849018],
                  [-79.79497800017735, -6.507158310048357]]]),
            {
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.81464303761125, -6.505324835253008],
                  [-79.81511510639787, -6.50675324061129],
                  [-79.8143640878737, -6.506689282249268],
                  [-79.81406368046403, -6.505879142292144],
                  [-79.81341995030046, -6.505879142292144],
                  [-79.8132482889235, -6.505495391330181],
                  [-79.81382764607072, -6.504770527602379]]]),
            {
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.80938527360878, -6.499418551750773],
                  [-79.80859133974037, -6.499546470317031],
                  [-79.80756137147866, -6.499439871514078],
                  [-79.80788323656044, -6.498096724660968],
                  [-79.81026503816567, -6.4982886030024325]]]),
            {
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.80874154344521, -6.501401285871252],
                  [-79.80771157518349, -6.501976916893387],
                  [-79.80678889528237, -6.501848998945416],
                  [-79.8068318106266, -6.501081490574176],
                  [-79.80762574449501, -6.501060170880462]]]),
            {
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79998931078175, -6.498303936252679],
                  [-79.79996785310964, -6.498922210391749],
                  [-79.79964598802785, -6.499433884966567],
                  [-79.79885205415944, -6.499668402306046],
                  [-79.79848727373341, -6.49902880930443],
                  [-79.79913100389699, -6.498133377735751]]]),
            {
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.80035561748248, -6.485140358039122],
                  [-79.79808110423785, -6.4841169793185305],
                  [-79.79829568095904, -6.482411343501084],
                  [-79.80258721538287, -6.483520007438774]]]),
            {
              "system:index": "16"
            })]),
    c09_arbustal_matorral = /* color: #4ed8df */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.74097850561286, -6.518069063196959],
                  [-79.74110725164557, -6.5179091708814605],
                  [-79.74134328603888, -6.518005106276874],
                  [-79.74145057439948, -6.518196977012653],
                  [-79.74112870931769, -6.5186020372137445],
                  [-79.74108579397345, -6.519230945824901],
                  [-79.74082830190802, -6.519763918606651],
                  [-79.7403562331214, -6.520115680332222],
                  [-79.74020602941657, -6.519827875302393],
                  [-79.74081757307196, -6.519071053879899]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79735328815441, -6.4940678721352585],
                  [-79.79720308444958, -6.49470747144347],
                  [-79.79632331989269, -6.495304430064461],
                  [-79.7953148093031, -6.495944027801148],
                  [-79.79484274051647, -6.497244540691861],
                  [-79.79407026432018, -6.496967382488819],
                  [-79.79458524845104, -6.495730828645905],
                  [-79.79522897861462, -6.49500595084248],
                  [-79.79595853946667, -6.49428107199497],
                  [-79.79681684635143, -6.493577512115218]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79226781986218, -6.496540984955229],
                  [-79.7920747008131, -6.496988702356014],
                  [-79.7916240896986, -6.497649617790884],
                  [-79.79055120609264, -6.498374491785556],
                  [-79.78999330661755, -6.49809733420505],
                  [-79.79059412143688, -6.4966475843725116],
                  [-79.79091598651867, -6.495688188804024],
                  [-79.79179575107555, -6.495944027801148]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79803993366222, -6.496029307437951],
                  [-79.79726745746594, -6.497073981815749],
                  [-79.79668810031872, -6.498203933292547],
                  [-79.79580833576183, -6.498459771010375],
                  [-79.79578687808971, -6.497713577303021],
                  [-79.79683830402355, -6.496455705405152],
                  [-79.79746057651501, -6.495944027801148]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78268469860768, -6.5088683122432505],
                  [-79.78210534146046, -6.509742405360384],
                  [-79.78154744198537, -6.508932270327801],
                  [-79.78004540493703, -6.507098802007399],
                  [-79.77980937054372, -6.506288662710685],
                  [-79.78038872769093, -6.505947551037008],
                  [-79.78144015362477, -6.50635262112371],
                  [-79.78191222241139, -6.507610468258453],
                  [-79.78247012188649, -6.508036856402855]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.7711300977259, -6.532754787328373],
                  [-79.77115155539802, -6.533095880763617],
                  [-79.77089406333259, -6.5333943373287],
                  [-79.77059365592292, -6.533671475408284],
                  [-79.76969243369392, -6.534215091964582],
                  [-79.76943494162849, -6.534055204803465],
                  [-79.76986409507087, -6.533650157099918],
                  [-79.77026106200508, -6.533127858261255],
                  [-79.77046490989021, -6.532882697393836]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76717115721992, -6.533383678168727],
                  [-79.76703168235115, -6.533799385239378],
                  [-79.76636649451545, -6.534694753141302],
                  [-79.76591588340095, -6.534609480076836],
                  [-79.765744222024, -6.534097841384768],
                  [-79.76654888472846, -6.532935993244802]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.82011813350421, -6.478936092671754],
                  [-79.8194314879964, -6.479298543263079],
                  [-79.81810111232501, -6.479597031789836],
                  [-79.81790799327594, -6.478808168871472],
                  [-79.81874484248858, -6.478467038578804],
                  [-79.8197748107503, -6.478424397276005]]]),
            {
              "system:index": "7"
            })]),
    c03_agricultura_01 = /* color: #ffc82d */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.75836967856858, -6.546725285512136],
                  [-79.76165270240281, -6.551607026636502],
                  [-79.75918507010911, -6.553056617424246],
                  [-79.75618099601243, -6.547514041678985],
                  [-79.75828384788011, -6.546384201378348]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.75598787696336, -6.548835738407892],
                  [-79.75858425528978, -6.553397696997347],
                  [-79.7570393028972, -6.554143807750328],
                  [-79.75375627906297, -6.548942326701273],
                  [-79.75575184257005, -6.547812489633353]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76550640127246, -6.555459134209492],
                  [-79.76441205999438, -6.55793194391377],
                  [-79.76348938009326, -6.5575908674424985],
                  [-79.7634250070769, -6.555757577410864],
                  [-79.76269544622485, -6.554862247270838],
                  [-79.7641974832732, -6.554158772461561]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76672948858325, -6.556098655136534],
                  [-79.76823152563159, -6.557079252297959],
                  [-79.76934732458179, -6.557825357541571],
                  [-79.76885379812305, -6.558571461668285],
                  [-79.7655493166167, -6.556930031115224],
                  [-79.76615013143604, -6.555608355832505]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.75926221868579, -6.56127874440394],
                  [-79.7583824541289, -6.562962794746196],
                  [-79.7573739435393, -6.5623232826285784],
                  [-79.75821079275195, -6.5605539614914985]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76716834402521, -6.567295451808901],
                  [-79.7673292765661, -6.567327427114947],
                  [-79.76750093794305, -6.567561912629859],
                  [-79.76690012312372, -6.567998908067377],
                  [-79.76641732550104, -6.567359402418944],
                  [-79.76674991941888, -6.567060966168446]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78059432324956, -6.54058032002038],
                  [-79.78026172933171, -6.540516365976267],
                  [-79.780132983299, -6.541070634086648],
                  [-79.7784592848737, -6.539930120190544],
                  [-79.77983257588933, -6.539215965304301],
                  [-79.78077671346257, -6.540303185770121]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79733454230356, -6.514759563954904],
                  [-79.79769932272958, -6.51561232773661],
                  [-79.7987292909913, -6.517317850951073],
                  [-79.7987292909913, -6.518469075842201],
                  [-79.79830013754892, -6.518831497946137],
                  [-79.79731308463144, -6.516955427753229],
                  [-79.79690538886118, -6.515548370503266],
                  [-79.7962616586976, -6.5151433078360474],
                  [-79.79619728568125, -6.514354500650837],
                  [-79.79724871161508, -6.514354500650837]]]),
            {
              "system:index": "7"
            })]),
    c03_agricultura = /* color: #00ffff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.81927789478898, -6.497798990731892],
                  [-79.81666005879045, -6.498033508833661],
                  [-79.81642402439714, -6.496562438932839],
                  [-79.81893457203508, -6.495922841982208],
                  [-79.81934226780534, -6.497074115907959]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.8306933725259, -6.4902943559801525],
                  [-79.83090794801053, -6.49159487597799],
                  [-79.8298136130355, -6.49189335550308],
                  [-79.8291269714815, -6.490507556210287],
                  [-79.82989944322931, -6.490081155659828]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.81378469560767, -6.491658850950807],
                  [-79.81440695665357, -6.492127884144869],
                  [-79.81082359131545, -6.4933004652068105],
                  [-79.81056610398174, -6.492468998917827],
                  [-79.81269037445333, -6.491701490347486]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.82706702976823, -6.511102390121375],
                  [-79.82741035252214, -6.512381544572526],
                  [-79.82659496098161, -6.512424182998081],
                  [-79.82599414616227, -6.5114434982937315]]]),
            {
              "system:index": "3"
            })]),
    c15_agua_2_4 = 
    /* color: #bf04c2 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.7842410643007, -6.476268727553072],
                  [-79.78403721641557, -6.476092831389586],
                  [-79.78365634273545, -6.476055520074305],
                  [-79.78321109603898, -6.476284718110362],
                  [-79.7828892309572, -6.476226086064529],
                  [-79.78309844326036, -6.475991557813114],
                  [-79.78361342739122, -6.475773020026217],
                  [-79.78392456363694, -6.475709057729226],
                  [-79.78426252197282, -6.475900944595888]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.7825834591295, -6.477201509213731],
                  [-79.78256200145738, -6.477302782547424],
                  [-79.78256200145738, -6.477675894654076],
                  [-79.78236351799028, -6.477990374644007],
                  [-79.78213821243303, -6.4778837712795525],
                  [-79.7821167547609, -6.477569291223186],
                  [-79.7824225265886, -6.47696698141557]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79002699648704, -6.474344361844676],
                  [-79.7893886307415, -6.47461087208246],
                  [-79.78900775706138, -6.474642853301538],
                  [-79.78889510428276, -6.474408324314588],
                  [-79.79005918299522, -6.473939266013841]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79518220221367, -6.474658843910326],
                  [-79.79455456530418, -6.474562900250039],
                  [-79.79390010630455, -6.474365682668888],
                  [-79.79326710497703, -6.474061860839051],
                  [-79.79335293566551, -6.47390195453938],
                  [-79.79383036887016, -6.473923275382266],
                  [-79.79491934573021, -6.474269738952901]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79820353819882, -6.473912614960938],
                  [-79.79851467444455, -6.473774029463187],
                  [-79.79867024256741, -6.473651434568093],
                  [-79.79876143767392, -6.4736727554215525],
                  [-79.79873461558377, -6.4738806336956],
                  [-79.7985790474609, -6.473955256644893],
                  [-79.7983430130676, -6.473992568115411],
                  [-79.79810697867428, -6.474093842092899],
                  [-79.79790313078915, -6.474323041019587],
                  [-79.79756517245328, -6.474472286776383],
                  [-79.79764563872372, -6.474355022256897],
                  [-79.79773683383023, -6.474141813969887],
                  [-79.79776365592038, -6.474104502510399],
                  [-79.79800505473172, -6.474024549373648]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.77600105423853, -6.485125647327686],
                  [-79.77578647751734, -6.484603298016752],
                  [-79.77563627381251, -6.484038307336355],
                  [-79.77522857804225, -6.483611898856413],
                  [-79.77515347618983, -6.483110868431625],
                  [-79.77560408730433, -6.483643879504913],
                  [-79.7760117830746, -6.484294152251217],
                  [-79.77623708863185, -6.48473122034703]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76957244615208, -6.491292193273094],
                  [-79.76818306188237, -6.49038075782998],
                  [-79.76820451955449, -6.489996995044662],
                  [-79.76936859826695, -6.490897771120063],
                  [-79.76976020078313, -6.491068332089006],
                  [-79.77031810025822, -6.491260213110024],
                  [-79.7704951260532, -6.491452094057927],
                  [-79.77017862538945, -6.491420113905022]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78144009973693, -6.482531609931917],
                  [-79.78072126772093, -6.482382366558974],
                  [-79.78000243570494, -6.482019918183642],
                  [-79.77998097803282, -6.481700110577298],
                  [-79.78069981004882, -6.482105200177733],
                  [-79.7812362518518, -6.482318405099907],
                  [-79.78191216852355, -6.482105200177733],
                  [-79.78211601640868, -6.482297084611739],
                  [-79.78193362619567, -6.48241434728546]]]),
            {
              "system:index": "7"
            })]),
    c15_agua_5_7 = 
    /* color: #ff0000 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.80586980231749, -6.473261368867499],
                  [-79.80627213366972, -6.473144104066789],
                  [-79.80671201594816, -6.472792309501304],
                  [-79.80704460986601, -6.47215268239077],
                  [-79.80722700007902, -6.471806217367665],
                  [-79.80743621238219, -6.471944803405423],
                  [-79.80724309333311, -6.472371221744638],
                  [-79.80683003314482, -6.472973537035353],
                  [-79.80623994716154, -6.473389294073573]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.80401907809721, -6.473042829898823],
                  [-79.80350945838438, -6.472579100554469],
                  [-79.8036918485974, -6.472403203105568],
                  [-79.8042497480725, -6.473016178798606]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79791973479735, -6.47422080712305],
                  [-79.79810212501036, -6.474178165461525],
                  [-79.7984508121823, -6.474044910246013],
                  [-79.79859028705107, -6.4743593924981715],
                  [-79.79828451522337, -6.474705855769542],
                  [-79.79772661574827, -6.47496703561692],
                  [-79.79730282672392, -6.474684534959706]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.79535554297911, -6.474636563134282],
                  [-79.79291473277556, -6.473996938359814],
                  [-79.79235146888243, -6.473858352885219],
                  [-79.79248021491514, -6.4736344839612885],
                  [-79.79584370501982, -6.474481987221375],
                  [-79.79680393584715, -6.474759157790186],
                  [-79.79675565608488, -6.474951045017916],
                  [-79.79587052710997, -6.474881752416307]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.77998819690806, -6.482203238952199],
                  [-79.77943029743297, -6.481531642988786],
                  [-79.77903333049876, -6.4809133475016045],
                  [-79.77889385562999, -6.4805402377891985],
                  [-79.77962341648204, -6.48125447613999],
                  [-79.78022423130137, -6.482053995482069]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76869167584636, -6.490827182098884],
                  [-79.76774753827311, -6.490027676674848],
                  [-79.76667465466716, -6.488599223824575],
                  [-79.76627768773295, -6.487778394607956],
                  [-79.7665566374705, -6.487650473051148],
                  [-79.76728619832255, -6.489014967982503],
                  [-79.76882042187907, -6.4906672811156225]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76295534344574, -6.484257045777003],
                  [-79.76290169926544, -6.48447024978922],
                  [-79.76270858021637, -6.484896657543129],
                  [-79.76232234211822, -6.485077880729308],
                  [-79.7616142389383, -6.484768735254833],
                  [-79.76121727200409, -6.484267705979764],
                  [-79.76133528920074, -6.484001200843337],
                  [-79.76196829052826, -6.4845342109753075],
                  [-79.76253691883942, -6.484662133323118],
                  [-79.7628051397409, -6.484065162088925]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.75553098889252, -6.483063101642338],
                  [-79.75510183545013, -6.483638753631681],
                  [-79.75473705502411, -6.484214404963743],
                  [-79.75436154576202, -6.484257045777003],
                  [-79.75390020581146, -6.484726094484855],
                  [-79.75381437512299, -6.48447024978922],
                  [-79.75555244656464, -6.482668673047984]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.75154349482389, -6.478405819996278],
                  [-79.75174734270902, -6.479152042302456],
                  [-79.75195119059416, -6.48016477080967],
                  [-79.75197264826627, -6.4807937274907],
                  [-79.75197264826627, -6.481625228339735],
                  [-79.75189754641386, -6.482104939744424],
                  [-79.75170442736479, -6.481955696245199],
                  [-79.75166151202055, -6.479972885564418],
                  [-79.7514898506436, -6.4792266644723595],
                  [-79.75118944323393, -6.478277896061549]]]),
            {
              "system:index": "8"
            })]),
    c20_banco_arena_8_10 = 
    /* color: #ff5b1a */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.81495738687356, -6.468175705619747],
                  [-79.81506467523415, -6.46822900832949],
                  [-79.81518269243081, -6.468602127140254],
                  [-79.8148930138572, -6.468985906201069],
                  [-79.81479645433267, -6.468964585149779],
                  [-79.8149466580375, -6.468687411401176]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.80788237372785, -6.470586750514769],
                  [-79.80774289885908, -6.470959867584434],
                  [-79.80757123748212, -6.471301002949808],
                  [-79.80747467795759, -6.471109114335127],
                  [-79.80763561049848, -6.470682694930427]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.80300075332075, -6.471695440428838],
                  [-79.8032797030583, -6.471940631138931],
                  [-79.80294710914045, -6.472175161271988],
                  [-79.80229265014081, -6.471812705565899],
                  [-79.802507226862, -6.471460910073029]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.80068599221845, -6.473178427914944],
                  [-79.80047141549726, -6.473444938768127],
                  [-79.80007444856305, -6.473732770331581],
                  [-79.79998861787458, -6.473412957473173],
                  [-79.8004070424809, -6.473189088351769],
                  [-79.80099712846418, -6.472677387130174]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78229530712966, -6.481913935261237],
                  [-79.78226312062148, -6.482351005420441],
                  [-79.78215583226088, -6.482660152377462],
                  [-79.78179105183486, -6.482681472850272],
                  [-79.78121169468764, -6.482510909042557],
                  [-79.78078254124526, -6.482180441500948],
                  [-79.78131898304824, -6.482287043957392],
                  [-79.78180178067092, -6.482287043957392]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.77515502399126, -6.480364475210256],
                  [-79.77520866817156, -6.480545700025337],
                  [-79.77524085467974, -6.480812206988053],
                  [-79.77487607425371, -6.480929470007029],
                  [-79.77466149753252, -6.48122795756869],
                  [-79.77455420917192, -6.480961450825663],
                  [-79.77462931102434, -6.48062032198909],
                  [-79.77496190494219, -6.480151269462092]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.75966099648686, -6.482486957456611],
                  [-79.75838426499577, -6.481506214396119],
                  [-79.75735429673405, -6.481559515698417],
                  [-79.75725773720951, -6.481282348864951],
                  [-79.75792292504521, -6.481154425659663],
                  [-79.75851301102848, -6.4814102720377855],
                  [-79.75939277558537, -6.481815361871036],
                  [-79.76028326897831, -6.482465636975582],
                  [-79.76069096474858, -6.482849405496242],
                  [-79.76088408379765, -6.4834570383899415],
                  [-79.76077679543705, -6.48370222338529],
                  [-79.76059440522404, -6.483574300793899]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.81984563091514, -6.467197355752692],
                  [-79.81824703439285, -6.467261319125502],
                  [-79.81788225397837, -6.46703744728526],
                  [-79.82052154756552, -6.466845557057564],
                  [-79.82031769968684, -6.467058768417182],
                  [-79.82006557207926, -6.4670747593134745]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.77661912644353, -6.485368610947719],
                  [-79.77676933014837, -6.485603134839014],
                  [-79.77665131295171, -6.485954920471339],
                  [-79.77650110924688, -6.48637066681114],
                  [-79.77608268464056, -6.4865945300828045],
                  [-79.77626507485357, -6.486200104251677],
                  [-79.77629726136175, -6.48561379501329]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.81708508956285, -6.466892730118724],
                  [-79.8166076563582, -6.466887399833914],
                  [-79.81594246852251, -6.466930042110839],
                  [-79.81616777407976, -6.466748812409028],
                  [-79.81664520728441, -6.466791454697657],
                  [-79.81700998771043, -6.466727491263363],
                  [-79.81723529326769, -6.466780794125836]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78261474446396, -6.4767641990671585],
                  [-79.78230360821823, -6.477734291005984],
                  [-79.78228215054611, -6.4787043810799085],
                  [-79.7818851836119, -6.478491174630165],
                  [-79.78177789525131, -6.477776932367113],
                  [-79.78201392964462, -6.477403820335154],
                  [-79.7824967272673, -6.476582972893854]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.72961282846465, -6.47094307567516],
                  [-79.7298917782022, -6.470815149849488],
                  [-79.72973084566131, -6.471294871528681],
                  [-79.72901201364532, -6.471678648544003],
                  [-79.72828245279327, -6.471444118180407],
                  [-79.72772455331817, -6.471071001468413],
                  [-79.72752070543304, -6.470697884480845],
                  [-79.72856140253081, -6.470953736159158],
                  [-79.72894764062896, -6.471113643392311]]]),
            {
              "system:index": "11"
            })]),
    c15_agua_8 = 
    /* color: #0000ff */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78090212371242, -6.482753957113887],
                  [-79.78049442794216, -6.482498111417473],
                  [-79.78023693587673, -6.482327547547737],
                  [-79.77975413825405, -6.481997079885954],
                  [-79.77979705359829, -6.481570669679786],
                  [-79.7801403763522, -6.481762554317184],
                  [-79.78054807212246, -6.482252925836583],
                  [-79.78108451392544, -6.482615374044439]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.77829501654995, -6.480270116324325],
                  [-79.7778551342715, -6.480035589952515],
                  [-79.77724359061611, -6.480014269367864],
                  [-79.77716848876369, -6.4797477619835595],
                  [-79.77778003241909, -6.479833044361848],
                  [-79.77863833930385, -6.480099551701089],
                  [-79.77865979697597, -6.480430020606202]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78501915074985, -6.4756445744671245],
                  [-79.78462754823367, -6.4754580176974414],
                  [-79.7839301738898, -6.4756445744671245],
                  [-79.7841823015372, -6.475404715750587],
                  [-79.78453098870914, -6.475287451447684],
                  [-79.78493332006137, -6.475330093015536],
                  [-79.78537320233981, -6.475697876388648],
                  [-79.78550731279056, -6.476044338741399],
                  [-79.78548585511844, -6.476262876410831],
                  [-79.7853517446677, -6.475900423639134]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78727220632236, -6.475452687503012],
                  [-79.78688596822421, -6.475671225428592],
                  [-79.78661238290469, -6.476033678364865],
                  [-79.78642999269168, -6.476070989681761],
                  [-79.78653728105228, -6.475783159451392],
                  [-79.78712736703555, -6.475298111839981]]]),
            {
              "system:index": "3"
            })]),
    c15_agua_11_12 = /* color: #999900 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.72526764986053, -6.469333340008129],
                  [-79.72422695276275, -6.468544461053777],
                  [-79.723551036091, -6.467990112943693],
                  [-79.72373342630401, -6.46791548911321],
                  [-79.72413039323821, -6.468150021114779],
                  [-79.72577190515533, -6.4693759820787],
                  [-79.72649073717132, -6.469887686644648],
                  [-79.72632980463042, -6.47021816223474],
                  [-79.72593283769622, -6.469749100042545],
                  [-79.72560024377837, -6.4694506056935035]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.74008219677711, -6.471728623052246],
                  [-79.73985152680183, -6.472405562287614],
                  [-79.73971205193305, -6.472384241380644],
                  [-79.7397925182035, -6.472000464901448],
                  [-79.74005001026893, -6.471440790346565]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76773715446976, -6.489902139005975],
                  [-79.7670075936177, -6.488836129534063],
                  [-79.76651406715897, -6.488111241804598],
                  [-79.76634240578201, -6.487567575323031],
                  [-79.7665569825032, -6.487620875984421],
                  [-79.76690030525711, -6.488345764419435],
                  [-79.7672221703389, -6.488878769956254],
                  [-79.76781668747107, -6.489640039604971],
                  [-79.7680205353562, -6.4899491820907045],
                  [-79.76804199302832, -6.490087763143388]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78150315594017, -6.482896970294201],
                  [-79.78162117313683, -6.4831634760143375],
                  [-79.7811491043502, -6.482918290756986],
                  [-79.78071995090782, -6.482726406559371],
                  [-79.78039808582604, -6.482502541569876],
                  [-79.78006549190819, -6.4822360355004],
                  [-79.78029079746544, -6.482097452288617],
                  [-79.78100962948143, -6.48260914395823]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.78277988743126, -6.476226083482898],
                  [-79.78298373531639, -6.476119479745773],
                  [-79.78313930343926, -6.475975564664933],
                  [-79.7833270580703, -6.475911602393602],
                  [-79.7834343464309, -6.475964904286935],
                  [-79.78326268505394, -6.476092828807968],
                  [-79.78285498928368, -6.476279385343028],
                  [-79.78248484443962, -6.476652498206294],
                  [-79.7821737081939, -6.477062922037284],
                  [-79.78205569099724, -6.477446694668199],
                  [-79.78194840263664, -6.477430704147741],
                  [-79.78205032657921, -6.476972309012403],
                  [-79.78254921745598, -6.476423300337255]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.77710442218323, -6.486108837703291],
                  [-79.77703468474884, -6.486375341725343],
                  [-79.77667526874085, -6.4867964177929105],
                  [-79.77625684413452, -6.487062921451322],
                  [-79.77610664042969, -6.4869723102232655],
                  [-79.77665381106873, -6.486556564379822],
                  [-79.7770454135849, -6.485970255556141]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.7734474966367, -6.488636155950043],
                  [-79.77319000457128, -6.4890039296187485],
                  [-79.77306125853856, -6.488860018215138],
                  [-79.77313636039098, -6.488577525340359],
                  [-79.7733563015302, -6.4884282837576475]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76986115396151, -6.491214704042019],
                  [-79.76988797605166, -6.491417245058745],
                  [-79.76968949258456, -6.491491865412794],
                  [-79.7693729919208, -6.491273334344716],
                  [-79.7691208642734, -6.491161403760922],
                  [-79.76883655011783, -6.490900232301988],
                  [-79.76895456731448, -6.490788301635259],
                  [-79.76945345819125, -6.491129423589544]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-79.76566086333615, -6.482906369428366],
                  [-79.76465235274655, -6.482639863572331],
                  [-79.7648776583038, -6.482405338302507],
                  [-79.76537118476254, -6.482533261190478],
                  [-79.76596127074582, -6.482821087569755],
                  [-79.7662831358276, -6.483386079614253],
                  [-79.7661007456146, -6.483322118282498],
                  [-79.7658861688934, -6.483044952417842]]]),
            {
              "system:index": "8"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
/**** SERNANP - COLECTA DE MUESTRAS ANP HUASCARÁN ****/ //CAMBIAR TÍTLO SEGÚN ANP

// === Importar módulo con utilidades Planet ===
var mosaic = require('users/ryali93/lulc:UTILES/planet.js'); // usa función getPlanetMonthlyImage()

//----------------------------------------------------
// 1. PARÁMETROS GENERALES
//----------------------------------------------------
var version = '1';
var year = 2023;
var regionId = 'SH04';
var region = 'BOSQUE DE POMAC';// Cambiar código según ANP
var tipo_muestra = 'MultiClass';  // 'MultiClass' o 'Urban_mining'

//----------------------------------------------------
// 2. CAPAS BASE
//----------------------------------------------------
var area_anp = ee.FeatureCollection(
  'projects/royyali/assets/anps_grupo2'
).filter(ee.Filter.eq('codigo', regionId));

var area_trabajo = ee.FeatureCollection('projects/ee-teledetecciondde/assets/Shp_ANP_ZA_ZR_ACR_ACP_Dissolve').filter(ee.Filter.eq('CODIGO', regionId));


var MapBiomas = ee.Image('projects/mapbiomas-public/assets/peru/collection3/mapbiomas_peru_collection3_integration_v1')
  .select('classification_' + year);

var WorldCover = ee.ImageCollection('ESA/WorldCover/v200').first().select('Map');

//----------------------------------------------------
// 3. COLORES Y CLASES
//----------------------------------------------------
var MB_COLORS = {
  1:'#1f8d49',3:'#1f8d49',4:'#76c975',5:'#04381d',6:'#026975',
  9:'#7a5900',10:'#b6db74',11:'#519769',12:'#dbbc74',13:'#b6db74',
  15:'#edd88e',18:'#e97e4d',21:'#ffcf63',22:'#d4271e',23:'#ffa07a',
  24:'#d4271e',25:'#db4b4b',27:'#ffffff',29:'#a3b58e',30:'#9c0027',
  31:'#091077',32:'#f5d1d5',33:'#2532e4',34:'#93d6f6',35:'#9056d0',
  40:'#c71585',61:'#dcdcdc',66:'#a39358',68:'#f9a47a',70:'#fbe9e0',
  72:'#f1d5ae'
};

var MB_CLASSES = {
  3:'Bosque',4:'Bosque seco',5:'Manglar',6:'Bosque inundable',
  9:'Plantación forestal',11:'Zona pantanosa/pastizal inun.',
  12:'Pastizal/herbazal',13:'Otra no boscosa',15:'Pasto',
  18:'Agricultura',21:'Mosaico agropecuario',23:'Playa',
  24:'Infraestructura urbana',25:'Otra área sin veg.',
  29:'Afloramiento rocoso',30:'Minería',31:'Acuicultura',
  32:'Salina costera',33:'Río/lago/océano',34:'Glaciar',
  35:'Palma aceitera',40:'Arroz',61:'Salar',66:'Matorral',
  68:'Área natural sin veg.',70:'Loma costera',72:'Otros cultivos',
  27:'No observado'
};

var WC_CLASSES = {
  10:'Bosque',20:'Matorrales',30:'Pastizales',40:'Cultivos',
  50:'Construcciones',60:'Escasa vegetación',70:'Nieve/hielo',
  80:'Agua',90:'Humedales herbáceos',95:'Manglares',100:'Musgo/líquenes'
};

var WC_COLOR_TABLE = {
  10:'#006400',20:'#ffbb22',30:'#ffff4c',40:'#f096ff',
  50:'#fa0000',60:'#b4b4b4',70:'#f0f0f0',80:'#0064c8',
  90:'#0096a0',95:'#00cf75',100:'#fae6a0'
};

//----------------------------------------------------
// 4. PANEL DE CONTROL
//----------------------------------------------------
var controlPanel = ui.Panel({style: {position: 'top-left', padding: '8px'}});

controlPanel.add(ui.Label({
  value: 'COLECTA DE MUESTRAS -' + region,
  style: {fontWeight: 'bold', fontSize: '16px', margin: '0 0 4px 0'}
}));

var monthSelect = ui.Select({
  items: [
    {label: 'Enero', value: 1},{label: 'Febrero', value: 2},{label: 'Marzo', value: 3},
    {label: 'Abril', value: 4},{label: 'Mayo', value: 5},{label: 'Junio', value: 6},
    {label: 'Julio', value: 7},{label: 'Agosto', value: 8},{label: 'Septiembre', value: 9},
    {label: 'Octubre', value: 10},{label: 'Noviembre', value: 11},{label: 'Diciembre', value: 12}
  ],
  value: 6,
  onChange: updateLayer
});
controlPanel.add(ui.Label('Selecciona mes:'));
controlPanel.add(monthSelect);

ui.root.insert(0, controlPanel);

// Panel leyendas (se usarán dos: una para MapBiomas, otra para WorldCover)
var legendPanel = ui.Panel({style:{position:'bottom-left', padding:'8px'}});
ui.root.add(legendPanel);

//----------------------------------------------------
// 5. FUNCIONES AUXILIARES
//----------------------------------------------------
function sortNumericArray(arrStr) {
  return arrStr.map(function(s){ return parseInt(s,10); }).sort(function(a,b){return a-b;});
}

function prepareRemapAndPalette(image, geom, bandName, colorDict, classNamesDict, callback) {
  var freq = image.reduceRegion({
    reducer: ee.Reducer.frequencyHistogram(),
    geometry: geom,
    scale: 30,
    maxPixels: 1e13
  }).get(bandName);

  ee.Dictionary(freq).keys().evaluate(function(classKeys) {
    if (!classKeys || !classKeys.length) { callback(null); return; }

    var origIds = sortNumericArray(classKeys);
    var palette = [], from = [], to = [], names = [];
    for (var i = 0; i < origIds.length; i++) {
      var id = origIds[i];
      from.push(id); to.push(i + 1);
      palette.push(colorDict[id] || '#FFFFFF');
      names.push(classNamesDict[id] || ('Clase ' + id));
    }
    var remapped = image.remap(from, to).rename('remap');
    callback({remappedImage: remapped, palette: palette, origIds: origIds, names: names});
  });
}

function drawLegend(origIds, names, palette, title) {
  var p = ui.Panel({style:{padding:'8px 12px', backgroundColor:'rgba(255,255,255,0.9)', margin:'4px'}});
  p.add(ui.Label({value: title, style:{fontWeight:'bold', fontSize:'14px', margin:'0 0 6px 0'}}));

  var grid = ui.Panel({layout: ui.Panel.Layout.Flow('horizontal')});
  var col1 = ui.Panel({layout: ui.Panel.Layout.Flow('vertical'), style:{padding:'0 8px'}});
  var col2 = ui.Panel({layout: ui.Panel.Layout.Flow('vertical'), style:{padding:'0 8px'}});

  for (var i = 0; i < origIds.length; i++) {
    var color = palette[i];
    var name = names[i];
    var row = ui.Panel({
      layout: ui.Panel.Layout.Flow('horizontal'),
      widgets: [
        ui.Label('', {backgroundColor: color, padding: '6px', margin: '0 8px 6px 0', border: '1px solid #999'}),
        ui.Label(origIds[i] + ' – ' + name, {fontSize: '12px', margin: '0 0 6px 0'})
      ]
    });
    if (i % 2 === 0) col1.add(row); else col2.add(row);
  }
  grid.add(col1); grid.add(col2); p.add(grid);
  legendPanel.add(p);
}

//----------------------------------------------------
// 6. FUNCIÓN PRINCIPAL: CARGA AMBAS REFERENCIAS
//----------------------------------------------------
function updateLayer() {
  Map.layers().reset();
  legendPanel.clear();

  var month = parseInt(monthSelect.getValue());
  var planetImage = mosaic.getPlanetMonthlyImage(year, month, area_trabajo.geometry());
  var rgbVis = {bands: ['R','G','B'], min: 0, max: 80, gamma: 1.6};
  Map.addLayer(planetImage, rgbVis, 'Planet ' + year + ' M' + month, true);

  Map.addLayer(planetImage.select('NDVI'),
    {min: 0.0, max: 0.8, palette: ['#a50026','#d73027','#f46d43','#fdae61','#fee08b','#d9ef8b','#a6d96a','#1a9850','#006837']},
    'NDVI ' + year + ' M' + month, false);

  Map.addLayer(planetImage.select('NDWI'),
    {min: -1, max: 1, palette: ['#ffeda0', '#253494', '#2c7fb8']},
    'NDWI ' + year + ' M' + month, false);

  var ndsi = planetImage.normalizedDifference(['G','N']).rename('NDSI');
  Map.addLayer(ndsi, {min: -0.5, max: 1.0, palette: ['#0000ff', '#00ffff', '#ffffff']}, 'NDSI', false);

  // --- Añadir MapBiomas ---
  prepareRemapAndPalette(MapBiomas.clip(area_trabajo), area_trabajo.geometry(), 'classification_' + year,
    MB_COLORS, MB_CLASSES, function(result) {
      if (result) {
        Map.addLayer(result.remappedImage.clip(area_trabajo),
          {min: 1, max: result.palette.length, palette: result.palette},
          'MapBiomas Perú C3 (' + year + ')', true);
        drawLegend(result.origIds, result.names, result.palette, 'MapBiomas C3 (' + year + ')');
      } else {
        ui.alert('No se encontraron clases MapBiomas en el área.');
      }
    });

  // --- Añadir WorldCover ---
  prepareRemapAndPalette(WorldCover.clip(area_trabajo), area_trabajo.geometry(), 'Map',
    WC_COLOR_TABLE, WC_CLASSES, function(result) {
      if (result) {
        Map.addLayer(result.remappedImage.clip(area_trabajo),
          {min: 1, max: result.palette.length, palette: result.palette},
          'WorldCover (2021)', true);
        drawLegend(result.origIds, result.names, result.palette, 'WorldCover (2021)');
      } else {
        ui.alert('No se encontraron clases WorldCover en el área.');
      }
    });

  // --- Límite ANP ---
  Map.addLayer(area_trabajo.style({color: 'cyan', fillColor: '00000000'}), {}, 'Límite ANP + ZA', true);
  Map.addLayer(area_anp.style({color: 'red', fillColor: '00000000'}), {}, 'Límite ANP', true);
}
  Map.centerObject(area_trabajo)

// Carga inicial
updateLayer();


//----------------------------------------------------
// 7. EXPORTAR MUESTRAS MANUALES
//----------------------------------------------------

// (al terminar de dibujar tus polígonos de muestra)
// var list_geom = ee.FeatureCollection([Bosque, Pastizal, Urbano, Mineria]).flatten();

// Export.table.toAsset({
//   collection: list_geom,
//   description: tipo_muestra + '-' + year + '-draw-' + version,
//   assetId: 'projects/ee-anp-lineabase/assets/AUXILIAR-DATA/geometry/' +
//             tipo_muestra + '-' + year + '-draw-' + version
// });
